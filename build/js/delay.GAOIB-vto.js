/*! For license information please see delay.GAOIB-vto.js.LICENSE.txt */
(()=>{class e{constructor(){this.triggerEvents=["wheel","keydown","touchend","mousedown","mousemove","touchmove","touchstart"],this.userEventHandler=this.triggerListener.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.clickHandler=this.onClick.bind(this),this.interceptedClicks=[],this.interceptedClickListeners=[],this.interceptClickListeners(this),window.addEventListener("pageshow",(e=>{this.persisted=e.persisted,this.everythingLoaded&&this.triggerLastFunctions()})),document.addEventListener("DOMContentLoaded",(()=>{this.preconnect3rdParties()})),this.delayedAssets={normal:[],async:[],defer:[]},this.trash=[],this.allJQueries=[]}addUserInteractionListener(e){document.hidden?e.triggerListener():(this.triggerEvents.forEach((t=>window.addEventListener(t,e.userEventHandler,{passive:!0}))),window.addEventListener("touchstart",e.touchStartHandler,{passive:!0}),window.addEventListener("mousedown",e.touchStartHandler),document.addEventListener("visibilitychange",e.userEventHandler))}removeUserInteractionListener(){this.triggerEvents.forEach((e=>window.removeEventListener(e,this.userEventHandler,{passive:!0}))),document.removeEventListener("visibilitychange",this.userEventHandler)}onTouchStart(e){"HTML"!==e.target.tagName&&(window.addEventListener("touchend",this.touchEndHandler),window.addEventListener("mouseup",this.touchEndHandler),window.addEventListener("touchmove",this.touchMoveHandler,{passive:!0})),window.addEventListener("mousemove",this.touchMoveHandler),e.target.addEventListener("click",this.clickHandler),this.disableOtherEventListeners(e.target,!0),this.renameDOMAttribute(e.target,"onclick","cover-onclick"),this.pendingClickStarted()}onTouchMove(e){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler),e.target.removeEventListener("click",this.clickHandler),this.disableOtherEventListeners(e.target,!1),this.renameDOMAttribute(e.target,"cover-onclick","onclick"),this.pendingClickFinished()}onTouchEnd(){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler)}onClick(e){e.target.removeEventListener("click",this.clickHandler),this.disableOtherEventListeners(e.target,!1),this.renameDOMAttribute(e.target,"cover-onclick","onclick"),this.interceptedClicks.push(e),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.pendingClickFinished()}replayClicks(){window.removeEventListener("touchstart",this.touchStartHandler,{passive:!0}),window.removeEventListener("mousedown",this.touchStartHandler),this.interceptedClicks.forEach((e=>{e.target.dispatchEvent(new MouseEvent("click",{view:e.view,bubbles:!0,cancelable:!0}))}))}interceptClickListeners(e){EventTarget.prototype.addEventListenerBase=EventTarget.prototype.addEventListener,EventTarget.prototype.addEventListener=function(t,i,n){("click"!==t||e.windowLoaded||i===e.clickHandler)&&e.interceptedClickListeners.push({target:this,func:i,options:n}),(this||window).addEventListenerBase(t,i,n)}}disableOtherEventListeners(e,t){this.interceptedClickListeners.forEach((i=>{i.target===e&&(t?e.removeEventListener("click",i.func,i.options):e.addEventListener("click",i.func,i.options))})),e.parentNode!==document.documentElement&&this.disableOtherEventListeners(e.parentNode,t)}waitForPendingClicks(){return new Promise((e=>{this.isClickPending?this.pendingClickFinished=e:e()}))}pendingClickStarted(){this.isClickPending=!0}pendingClickFinished(){this.isClickPending=!1}triggerListener(){this.removeUserInteractionListener(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.loadEverythingNow.bind(this)):this.loadEverythingNow()}preconnect3rdParties(){let e=[];document.querySelectorAll("script[type=coverdelayasset][data-cover-src]").forEach((t=>{let i=t.getAttribute("data-cover-src");if(i&&0!==i.indexOf("data:")){0===i.indexOf("//")&&(i=location.protocol+i);try{let n=new URL(i).origin;n!==location.origin&&e.push({src:n,crossOrigin:t.crossOrigin||"module"===t.getAttribute("data-cover-type")})}catch(e){}}})),e.length>0&&(e=[...new Map(e.map((e=>[JSON.stringify(e),e]))).values()],this.batchInjectResourceHints(e,"preconnect"))}async loadEverythingNow(){this.lastBreath=Date.now(),this.delayEventListeners(this),this.delayJQueryReady(this),this.handleDocumentWrite(),this.registerAlldelayedAssets(),this.preloadAllScripts(),await this.loadScriptsFromList(this.delayedAssets.normal),await this.loadScriptsFromList(this.delayedAssets.defer),await this.loadScriptsFromList(this.delayedAssets.async);try{await this.triggerDOMContentLoaded(),await this.pendingWebpackRequests(this),await this.triggerWindowLoad()}catch(e){}window.dispatchEvent(new Event("cover-delay-loaded")),this.everythingLoaded=!0,this.waitForPendingClicks().then((()=>this.replayClicks())),this.emptyTrash()}registerAlldelayedAssets(){document.querySelectorAll("[type=coverdelayasset]").forEach((e=>{e.hasAttribute("data-cover-src")?e.hasAttribute("async")&&!1!==e.async?this.delayedAssets.async.push(e):e.hasAttribute("defer")&&!1!==e.defer||"module"===e.getAttribute("data-cover-type")?this.delayedAssets.defer.push(e):this.delayedAssets.normal.push(e):this.delayedAssets.normal.push(e)}))}async transformScript(e){if(await this.littleBreath(),!0!==e.noModule||!("noModule"in HTMLScriptElement.prototype))return new Promise((t=>{let i;function n(){(i||e).setAttribute("data-cover-status","executed"),t()}try{if(navigator.userAgent.indexOf("Firefox/")>0||""===navigator.vendor)i=document.createElement("script"),e.attributes.forEach((e=>{let t=e.nodeName;if("type"!==t){switch(t){case"data-cover-type":t="type";break;case"data-cover-src":t="src"}i.setAttribute(t,e.nodeValue)}})),e.text&&(i.text=e.text),i.hasAttribute("src")?(i.addEventListener("load",n),i.addEventListener("error",(function(){i.setAttribute("data-cover-status","failed"),t()})),setTimeout((()=>{i.isConnected||t()}),1)):(i.text=e.text,n()),e.parentNode.replaceChild(i,e);else{let i=e.getAttribute("data-cover-type"),r=e.getAttribute("data-cover-src");i?(e.type=i,e.removeAttribute("data-cover-type")):e.removeAttribute("type"),e.addEventListener("load",n),e.addEventListener("error",(function(){e.setAttribute("data-cover-status","failed"),t()})),r?(e.removeAttribute("data-cover-src"),e.src=r):e.src="data:text/javascript;base64,"+window.btoa(unescape(encodeURIComponent(e.text)))}}catch(i){e.setAttribute("data-cover-status","failed"),t()}}));e.setAttribute("data-cover-status","skipped")}async loadScriptsFromList(e){let t=e.shift();return t&&t.isConnected?(await this.transformScript(t),this.loadScriptsFromList(e)):Promise.resolve()}preloadAllScripts(){this.batchInjectResourceHints([...this.delayedAssets.normal,...this.delayedAssets.defer,...this.delayedAssets.async],"preload")}batchInjectResourceHints(e,t){let i=document.createDocumentFragment();e.forEach((e=>{let n=this.getAttribute(e,"data-cover-src",e.src);if(n){let r=document.createElement("link");r.href=n,r.rel=t,"preconnect"!==t&&(r.as="script"),"module"===this.getAttribute(e,"data-cover-type")&&(r.crossOrigin=!0),e.crossOrigin&&(r.crossOrigin=e.crossOrigin),e.integrity&&(r.integrity=e.integrity),i.appendChild(r),this.trash.push(r)}})),document.head.appendChild(i)}delayEventListeners(e){let t={};function i(i,n){return t[n].eventsToRewrite.indexOf(i)>=0&&!e.everythingLoaded?"cover-"+i:i}function n(e,n){let r=e;t[e]||(t[r]={originalFunctions:{add:r.addEventListener,remove:r.removeEventListener},eventsToRewrite:[]},r.addEventListener=function(){arguments[0]=i(arguments[0],r),t[r].originalFunctions.add.apply(r,arguments)},r.removeEventListener=function(){arguments[0]=i(arguments[0],r),t[r].originalFunctions.remove.apply(r,arguments)}),t[e].eventsToRewrite.push(n)}function r(t,i){let n=t[i];t[i]=null,Object.defineProperty(t,i,{get:()=>n||function(){},set(r){e.everythingLoaded?n=r:t["cover"+i]=n=r}})}n(document,"DOMContentLoaded"),n(window,"DOMContentLoaded"),n(window,"load"),n(window,"pageshow"),n(document,"readystatechange"),r(document,"onreadystatechange"),r(window,"onload"),r(window,"onpageshow")}delayJQueryReady(e){let t;function i(t){return e.everythingLoaded||(t=t.split(" ").map((e=>"load"===e||0===e.indexOf("load.")?"cover-jquery-load":e)).join(" ")),t}function n(n){if(n&&n.fn&&!e.allJQueries.includes(n)){n.fn.ready=n.fn.init.prototype.ready=function(t){return e.domReadyFired?t.bind(document)(n):document.addEventListener("cover-DOMContentLoaded",(()=>t.bind(document)(n))),n([])};let t=n.fn.on;n.fn.on=n.fn.init.prototype.on=function(){return this[0]===window&&("string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=i(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach((e=>{let t=arguments[0][e];delete arguments[0][e],arguments[0][i(e)]=t}))),t.apply(this,arguments),this},e.allJQueries.push(n)}t=n}n(window.jQuery),Object.defineProperty(window,"jQuery",{get:()=>t,set(e){n(e)}})}async pendingWebpackRequests(e){let t=document.querySelector("script[data-webpack]");t&&(await async function(){return new Promise((e=>{t.addEventListener("load",e),t.addEventListener("error",e)}))}(),await e.requestAnimFrame(),await e.pendingWebpackRequests(e))}async triggerDOMContentLoaded(){this.domReadyFired=!0,await this.littleBreath(),document.dispatchEvent(new Event("cover-readystatechange")),await this.littleBreath(),document.optonreadystatechange&&document.optonreadystatechange(),await this.littleBreath(),document.dispatchEvent(new Event("cover-DOMContentLoaded")),await this.littleBreath(),window.dispatchEvent(new Event("cover-DOMContentLoaded"))}async triggerWindowLoad(){await this.littleBreath(),window.dispatchEvent(new Event("cover-load")),await this.littleBreath(),window.optonload&&window.optonload(),await this.littleBreath(),this.allJQueries.forEach((e=>e(window).trigger("cover-jquery-load"))),await this.littleBreath();const e=new Event("cover-pageshow");e.persisted=this.persisted,window.dispatchEvent(e),await this.littleBreath(),window.optonpageshow&&window.optonpageshow({persisted:this.persisted})}triggerLastFunctions(){document.onreadystatechange&&document.onreadystatechange(),window.onload&&window.onload(),window.onpageshow&&window.onpageshow({persisted:this.persisted})}handleDocumentWrite(){let e=new Map;document.write=document.writeln=function(t){let i=document.currentScript;i||console.error("Optimization unable to document.write this: "+t);let n=document.createRange(),r=i.parentElement,s=e.get(i);void 0===s&&(s=i.nextSibling,e.set(i,s));let o=document.createDocumentFragment();n.setStart(o,0),o.appendChild(n.createContextualFragment(t)),r.insertBefore(o,s)}}async littleBreath(){Date.now()-this.lastBreath>45&&(await this.requestAnimFrame(),this.lastBreath=Date.now())}async requestAnimFrame(){return document.hidden?new Promise((e=>setTimeout(e))):new Promise((e=>requestAnimationFrame(e)))}emptyTrash(){this.trash.forEach((e=>e.remove()))}getAttribute(e,t,i=!1){return e.getAttribute&&e.getAttribute(t)||i}renameDOMAttribute(e,t,i){e.hasAttribute&&e.hasAttribute(t)&&(event.target.setAttribute(i,event.target.getAttribute(t)),event.target.removeAttribute(t))}static init(){const t=new e;t.addUserInteractionListener(t)}}e.init()})();