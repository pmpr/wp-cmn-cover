!function(t){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(){},r=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}}var c,a=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},l=o(!1),f=o(!0),s=l,d=f,m=function(){return g},g=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},r={fold:function(t,n){return t()},is:s,isSome:s,isNone:d,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:e,orThunk:n,map:m,ap:m,each:function(){},bind:m,flatten:m,exists:s,forall:d,filter:m,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(r),r}(),h=function(t){var n=function(){return t},e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:d,isNone:s,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return h(n(t))},ap:function(n){return n.fold(m,(function(n){return h(n(t))}))},each:function(n){n(t)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(t)?o:g},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(s,(function(n){return e(t,n)}))},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},p={some:h,none:m,from:function(t){return null==t?g:h(t)}},v=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(n)===t}},b=v("string"),w=v("array"),y=v("boolean"),x=v("function"),C=v("number"),R=Array.prototype.slice,S=void 0===(c=Array.prototype.indexOf)?function(t,n){return B(t,n)}:function(t,n){return c.call(t,n)},T=function(t,n){return S(t,n)>-1},D=function(t,n){return I(t,n).isSome()},O=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o,t)}return r},N=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},E=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r,t)&&e.push(i)}return e},k=function(t,n,e){return function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e,t)}(t,(function(t){e=n(e,t)})),e},A=function(t,n,e){return N(t,(function(t){e=n(e,t)})),e},P=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e,t))return p.some(o)}return p.none()},I=function(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e,t))return p.some(e);return p.none()},B=function(t,n){for(var e=0,r=t.length;e<r;++e)if(t[e]===n)return e;return-1},W=Array.prototype.push,M=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!w(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);W.apply(n,t[e])}return n},_=function(t,n){var e=O(t,n);return M(e)},L=function(t,n){for(var e=0,r=t.length;e<r;++e)if(!0!==n(t[e],e,t))return!1;return!0},F=function(t){var n=R.call(t,0);return n.reverse(),n},j=(x(Array.from)&&Array.from,Object.keys),z=function(t,n){for(var e=j(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i,t)}},H=function(t,n){return U(t,(function(t,e,r){return{k:e,v:n(t,e,r)}}))},U=function(t,n){var e={};return z(t,(function(r,o){var i=n(r,o,t);e[i.k]=i.v})),e},q=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return N(t,(function(t,e){r[t]=o(n[e])})),r}},V=function(t){return t.slice(0).sort()},G=function(t,n){throw new Error("All required keys ("+V(t).join(", ")+") were not specified. Specified keys were: "+V(n).join(", ")+".")},Y=function(t){throw new Error("Unsupported keys for object: "+V(t).join(", "))},X=function(t,n){if(!w(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");N(n,(function(n){if(!b(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")}))},K=function(t){var n=V(t);P(n,(function(t,e){return e<n.length-1&&t===n[e+1]})).each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+n.join(", ")+"].")}))},J=function(t,n){var e=t.concat(n);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return X("required",t),X("optional",n),K(e),function(r){var i=j(r);L(t,(function(t){return T(i,t)}))||G(t,i);var u=E(i,(function(t){return!T(e,t)}));u.length>0&&Y(u);var c={};return N(t,(function(t){c[t]=o(r[t])})),N(n,(function(t){c[t]=o(Object.prototype.hasOwnProperty.call(r,t)?p.some(r[t]):p.none())})),c}},$=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),Q=t.Node.DOCUMENT_NODE,Z=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),tt=t.Node.TEXT_NODE,nt=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,void 0!==t.window?t.window:Function("return this;")()),et=function(t,n){return function(t,n){for(var e=null!=n?n:nt,r=0;r<t.length&&null!=e;++r)e=e[t[r]];return e}(t.split("."),n)},rt=function(t,n){var e=function(t,n){return et(t,n)}(t,n);if(null==e)throw new Error(t+" not available on this browser");return e},ot=function(t){return t.dom().nodeName.toLowerCase()},it=function(t){return t.dom().nodeType},ut=function(t){return function(n){return it(n)===t}},ct=function(t){return it(t)===$||"#comment"===ot(t)},at=ut(Z),lt=ut(tt),ft=function(n,e,r){if(!(b(r)||y(r)||C(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")},st=function(t,n,e){ft(t.dom(),n,e)},dt=function(t,n){var e=t.dom();z(n,(function(t,n){ft(e,n,t)}))},mt=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},gt=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},ht=function(t,n){t.dom().removeAttribute(n)},pt=function(t){return A(t.dom().attributes,(function(t,n){return t[n.name]=n.value,t}),{})},vt=function(t,n){return-1!==t.indexOf(n)},bt=function(t){return void 0!==t.style&&x(t.style.getPropertyValue)},wt=function(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}},yt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},xt={fromHtml:function(n,e){var r=(e||t.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return yt(r.childNodes[0])},fromTag:function(n,e){var r=(e||t.document).createElement(n);return yt(r)},fromText:function(n,e){var r=(e||t.document).createTextNode(n);return yt(r)},fromDom:yt,fromPoint:function(t,n,e){var r=t.dom();return p.from(r.elementFromPoint(n,e)).map(yt)}},Ct=function(t){var n=lt(t)?t.dom().parentNode:t.dom();return null!=n&&n.ownerDocument.body.contains(n)},Rt=wt((function(){return St(xt.fromDom(t.document))})),St=function(t){var n=t.dom().body;if(null==n)throw new Error("Body is not available yet");return xt.fromDom(n)},Tt=function(n,e,r){if(!b(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);bt(n)&&n.style.setProperty(e,r)},Dt=function(t,n,e){var r=t.dom();Tt(r,n,e)},Ot=function(t,n){var e=t.dom();z(n,(function(t,n){Tt(e,n,t)}))},Nt=function(n,e){var r=n.dom(),o=t.window.getComputedStyle(r).getPropertyValue(e),i=""!==o||Ct(n)?o:Et(r,e);return null===i?void 0:i},Et=function(t,n){return bt(t)?t.style.getPropertyValue(n):""},kt=function(t,n){var e=t.dom(),r=Et(e,n);return p.from(r).filter((function(t){return t.length>0}))},At=function(t,n){!function(t,n){bt(t)&&t.style.removeProperty(n)}(t.dom(),n),gt(t,"style")&&""===mt(t,"style").replace(/^\s+|\s+$/g,"")&&ht(t,"style")},Pt=function(){return rt("Node")},It=function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)},Bt=function(t,n){return It(t,n,Pt().DOCUMENT_POSITION_CONTAINED_BY)},Wt=function(){return Mt(0,0)},Mt=function(t,n){return{major:t,minor:n}},_t={nu:Mt,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Wt():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return Mt(r(1),r(2))}(t,e)},unknown:Wt},Lt="Edge",Ft="Chrome",jt="Opera",zt="Firefox",Ht="Safari",Ut=function(t,n){return function(){return n===t}},qt=function(t){var n=t.current;return{current:n,version:t.version,isEdge:Ut(Lt,n),isChrome:Ut(Ft,n),isIE:Ut("IE",n),isOpera:Ut(jt,n),isFirefox:Ut(zt,n),isSafari:Ut(Ht,n)}},Vt={unknown:function(){return qt({current:void 0,version:_t.unknown()})},nu:qt,edge:o(Lt),chrome:o(Ft),ie:o("IE"),opera:o(jt),firefox:o(zt),safari:o(Ht)},Gt="Windows",Yt="Android",Xt="Linux",Kt="Solaris",Jt="FreeBSD",$t=function(t,n){return function(){return n===t}},Qt=function(t){var n=t.current;return{current:n,version:t.version,isWindows:$t(Gt,n),isiOS:$t("iOS",n),isAndroid:$t(Yt,n),isOSX:$t("OSX",n),isLinux:$t(Xt,n),isSolaris:$t(Kt,n),isFreeBSD:$t(Jt,n)}},Zt={unknown:function(){return Qt({current:void 0,version:_t.unknown()})},nu:Qt,windows:o(Gt),ios:o("iOS"),android:o(Yt),linux:o(Xt),osx:o("OSX"),solaris:o(Kt),freebsd:o(Jt)},tn=function(t,n){var e=String(n).toLowerCase();return P(t,(function(t){return t.search(e)}))},nn=function(t,n){return tn(t,n).map((function(t){var e=_t.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},en=function(t,n){return tn(t,n).map((function(t){var e=_t.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},rn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,on=function(t){return function(n){return vt(n,t)}},un=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return vt(t,"edge/")&&vt(t,"chrome")&&vt(t,"safari")&&vt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,rn],search:function(t){return vt(t,"chrome")&&!vt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return vt(t,"msie")||vt(t,"trident")}},{name:"Opera",versionRegexes:[rn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:on("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:on("firefox")},{name:"Safari",versionRegexes:[rn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(vt(t,"safari")||vt(t,"mobile/"))&&vt(t,"applewebkit")}}],cn=[{name:"Windows",search:on("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return vt(t,"iphone")||vt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:on("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:on("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:on("linux"),versionRegexes:[]},{name:"Solaris",search:on("sunos"),versionRegexes:[]},{name:"FreeBSD",search:on("freebsd"),versionRegexes:[]}],an={browsers:o(un),oses:o(cn)},ln=function(t){var n=an.browsers(),e=an.oses(),r=nn(n,t).fold(Vt.unknown,Vt.nu),i=en(e,t).fold(Zt.unknown,Zt.nu),u=function(t,n,e){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isAndroid()&&3===t.version.major,c=t.isAndroid()&&4===t.version.major,a=r||u||c&&!0===/mobile/i.test(e),l=t.isiOS()||t.isAndroid(),f=l&&!a,s=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e);return{isiPad:o(r),isiPhone:o(i),isTablet:o(a),isPhone:o(f),isTouch:o(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o(s)}}(i,r,t);return{browser:r,os:i,deviceType:u}},fn={detect:wt((function(){var n=t.navigator.userAgent;return ln(n)}))},sn=Z,dn=Q,mn=function(t,n){var e=t.dom();if(e.nodeType!==sn)return!1;var r=e;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},gn=function(t){return t.nodeType!==sn&&t.nodeType!==dn||0===t.childElementCount},hn=function(t,n){return t.dom()===n.dom()},pn=fn.detect().browser.isIE()?function(t,n){return Bt(t.dom(),n.dom())}:function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},vn=mn,bn=function(t){return xt.fromDom(t.dom().ownerDocument)},wn=function(t){return p.from(t.dom().parentNode).map(xt.fromDom)},yn=function(t,n){for(var e=x(n)?n:l,r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=xt.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o},xn=function(t){return p.from(t.dom().previousSibling).map(xt.fromDom)},Cn=function(t){return p.from(t.dom().nextSibling).map(xt.fromDom)},Rn=function(t){return O(t.dom().childNodes,xt.fromDom)},Sn=function(t,n){var e=t.dom().childNodes;return p.from(e[n]).map(xt.fromDom)},Tn=(q("element","offset"),function(t,n){wn(t).each((function(e){e.dom().insertBefore(n.dom(),t.dom())}))}),Dn=function(t,n){Cn(t).fold((function(){wn(t).each((function(t){Nn(t,n)}))}),(function(t){Tn(t,n)}))},On=function(t,n){var e=function(t){return Sn(t,0)}(t);e.fold((function(){Nn(t,n)}),(function(e){t.dom().insertBefore(n.dom(),e.dom())}))},Nn=function(t,n){t.dom().appendChild(n.dom())},En=function(t,n){Tn(t,n),Nn(n,t)},kn=function(t,n){N(n,(function(e,r){var o=0===r?t:n[r-1];Dn(o,e)}))},An=function(t,n){N(n,(function(n){Nn(t,n)}))},Pn=function(t){t.dom().textContent="",N(Rn(t),(function(t){In(t)}))},In=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},Bn=function(t){var n,e=Rn(t);e.length>0&&(n=t,N(e,(function(t){Tn(n,t)}))),In(t)},Wn=(q("width","height"),q("width","height"),q("rows","columns")),Mn=q("row","column"),_n=(q("x","y"),q("element","rowspan","colspan")),Ln=q("element","rowspan","colspan","isNew"),Fn=q("element","rowspan","colspan","row","column"),jn=q("element","cells","section"),zn=q("element","isNew"),Hn=q("element","cells","section","isNew"),Un=q("cells","section"),qn=q("details","section"),Vn=q("startRow","startCol","finishRow","finishCol"),Gn=function(t,n){var e=[];return N(Rn(t),(function(t){n(t)&&(e=e.concat([t])),e=e.concat(Gn(t,n))})),e},Yn=function(t,n,e){return function(t,n,e){return E(yn(t,e),n)}(t,(function(t){return mn(t,n)}),e)},Xn=function(t,n){return function(t,n){return E(Rn(t),n)}(t,(function(t){return mn(t,n)}))},Kn=function(n,e){return function(n,e){var r=void 0===e?t.document:e.dom();return gn(r)?[]:O(r.querySelectorAll(n),xt.fromDom)}(e,n)};function Jn(t,n,e,r,o){return t(e,r)?p.some(e):x(o)&&o(e)?p.none():n(e,r,o)}var $n=function(t,n,e){for(var r=t.dom(),i=x(e)?e:o(!1);r.parentNode;){r=r.parentNode;var u=xt.fromDom(r);if(n(u))return p.some(u);if(i(u))break}return p.none()},Qn=function(t,n,e){return $n(t,(function(t){return mn(t,n)}),e)},Zn=function(t,n){return function(t,n){var e=P(t.dom().childNodes,(function(t){return n(xt.fromDom(t))}));return e.map(xt.fromDom)}(t,(function(t){return mn(t,n)}))},te=function(n,e){return function(n,e){var r=void 0===e?t.document:e.dom();return gn(r)?p.none():p.from(r.querySelector(n)).map(xt.fromDom)}(e,n)},ne=function(t,n,e){return Jn(mn,Qn,t,n,e)},ee=function(t,n,e){return _(Rn(t),(function(t){return mn(t,n)?e(t)?[t]:[]:ee(t,n,e)}))},re={firstLayer:function(t,n){return ee(t,n,o(!0))},filterFirstLayer:ee},oe=function(t,n,e){return void 0===e&&(e=l),e(n)?p.none():T(t,ot(n))?p.some(n):Qn(n,t.join(","),(function(t){return mn(t,"table")||e(t)}))},ie=function(t,n){return wn(n).map((function(n){return Xn(n,t)}))},ue=(u(ie,"th,td"),u(ie,"tr"),function(t,n){return oe(["td","th"],t,n)}),ce=function(t){return re.firstLayer(t,"th,td")},ae=function(t,n){return ne(t,"table",n)},le=function(t){return re.firstLayer(t,"tr")},fe=function(t){var n=le(t);return O(n,(function(t){var n=t,e=wn(n).map((function(t){var n=ot(t);return"tfoot"===n||"thead"===n||"tbody"===n?n:"tbody"})).getOr("tbody"),r=O(ce(t),(function(t){var n=gt(t,"rowspan")?parseInt(mt(t,"rowspan"),10):1,e=gt(t,"colspan")?parseInt(mt(t,"colspan"),10):1;return _n(t,n,e)}));return jn(n,r,e)}))},se=function(t,n){return O(t,(function(t){var e=O(ce(t),(function(t){var n=gt(t,"rowspan")?parseInt(mt(t,"rowspan"),10):1,e=gt(t,"colspan")?parseInt(mt(t,"colspan"),10):1;return _n(t,n,e)}));return jn(t,e,n.section())}))},de=function(t,n){return t+","+n},me=function(t,n){var e=_(t.all(),(function(t){return t.cells()}));return E(e,n)},ge={generate:function(t){var n={},e=[],r=t.length,i=0;N(t,(function(t,r){var o=[];N(t.cells(),(function(t){for(var e=0;void 0!==n[de(r,e)];)e++;for(var u=Fn(t.element(),t.rowspan(),t.colspan(),r,e),c=0;c<t.colspan();c++)for(var a=0;a<t.rowspan();a++){var l=e+c,f=de(r+a,l);n[f]=u,i=Math.max(i,l+1)}o.push(u)})),e.push(jn(t.element(),o,t.section()))}));var u=Wn(r,i);return{grid:o(u),access:o(n),all:o(e)}},getAt:function(t,n,e){var r=t.access()[de(n,e)];return void 0!==r?p.some(r):p.none()},findItem:function(t,n,e){var r=me(t,(function(t){return e(n,t.element())}));return r.length>0?p.some(r[0]):p.none()},filterItems:me,justCells:function(t){var n=O(t.all(),(function(t){return t.cells()}));return M(n)}},he=q("minRow","minCol","maxRow","maxCol"),pe=function(t,n,e){var r=t[e].element(),o=xt.fromTag("td");Nn(o,xt.fromTag("br")),(n?Nn:On)(r,o)},ve=function(t,n){var e=function(t){return mn(t.element(),n)},r=fe(t),o=ge.generate(r),i=function(t,n){var e=t.grid().columns(),r=t.grid().rows(),o=e,i=0,u=0;return z(t.access(),(function(t){if(n(t)){var e=t.row(),c=e+t.rowspan()-1,a=t.column(),l=a+t.colspan()-1;e<r?r=e:c>i&&(i=c),a<o?o=a:l>u&&(u=l)}})),he(r,o,i,u)}(o,e),u="th:not("+n+"),td:not("+n+")",c=re.filterFirstLayer(t,"th,td",(function(t){return mn(t,u)}));return N(c,In),function(t,n,e,r){for(var o=n.grid().columns(),i=n.grid().rows(),u=0;u<i;u++)for(var c=!1,a=0;a<o;a++)u<e.minRow()||u>e.maxRow()||a<e.minCol()||a>e.maxCol()||(ge.getAt(n,u,a).filter(r).isNone()?pe(t,c,u):c=!0)}(r,o,i,e),function(t,n){var e=E(re.firstLayer(t,"tr"),(function(t){return 0===t.dom().childElementCount}));N(e,In),n.minCol()!==n.maxCol()&&n.minRow()!==n.maxRow()||N(re.firstLayer(t,"th,td"),(function(t){ht(t,"rowspan"),ht(t,"colspan")})),ht(t,"width"),ht(t,"height"),At(t,"width"),At(t,"height")}(t,i),t},be=function(t,n){var e=function(n){return t(n)?p.from(n.dom().nodeValue):p.none()};return{get:function(r){if(!t(r))throw new Error("Can only get "+n+" value of a "+n+" node");return e(r).getOr("")},getOption:e,set:function(e,r){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom().nodeValue=r}}}(lt,"text"),we=function(t){return be.get(t)},ye=function(t){return be.getOption(t)},xe=function(t,n){be.set(t,n)},Ce=function(t){return"img"===ot(t)?1:ye(t).fold((function(){return Rn(t).length}),(function(t){return t.length}))},Re=["img","br"],Se=function(t){var n=ye(t).filter((function(t){return 0!==t.trim().length||t.indexOf(" ")>-1})).isSome();return n||T(Re,ot(t))},Te=function(t){return n=Se,e=function(t){for(var r=0;r<t.childNodes.length;r++){var o=xt.fromDom(t.childNodes[r]);if(n(o))return p.some(o);var i=e(t.childNodes[r]);if(i.isSome())return i}return p.none()},e(t.dom());var n,e},De=function(t){return Oe(t,Se)},Oe=function(t,n){var e=function(t){for(var r=Rn(t),o=r.length-1;o>=0;o--){var i=r[o];if(n(i))return p.some(i);var u=e(i);if(u.isSome())return u}return p.none()};return e(t)},Ne=function(t,n){return xt.fromDom(t.dom().cloneNode(n))},Ee=function(t){return Ne(t,!1)},ke=function(t){return Ne(t,!0)},Ae=function(t,n){var e=function(t,n){var e=xt.fromTag(n),r=pt(t);return dt(e,r),e}(t,n),r=Rn(ke(t));return An(e,r),e},Pe=function(){var t=xt.fromTag("td");return Nn(t,xt.fromTag("br")),t},Ie=function(t,n,e){var r=Ae(t,n);return z(e,(function(t,n){null===t?ht(r,n):st(r,n,t)})),r},Be=function(t){return t},We=function(t){return function(){return xt.fromTag("tr",t.dom())}},Me=function(t,n,e){return{row:We(n),cell:function(n){var r,o,i,u,c=bn(n.element()),a=xt.fromTag(ot(n.element()),c.dom()),l=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=l.length>0?function(t,n,e){return Te(t).map((function(r){var o=e.join(","),i=Yn(r,o,(function(n){return hn(n,t)}));return k(i,(function(t,n){var e=Ee(n);return ht(e,"contenteditable"),Nn(t,e),e}),n)})).getOr(n)}(n.element(),a,l):a;return Nn(f,xt.fromTag("br")),r=n.element(),o=a,i=r.dom(),u=o.dom(),bt(i)&&bt(u)&&(u.style.cssText=i.style.cssText),At(a,"height"),1!==n.colspan()&&At(n.element(),"width"),t(n.element(),a),a},replace:Ie,gap:Pe}},_e=function(t){return{row:We(t),cell:Pe,replace:Be,gap:Pe}},Le=function(t,n){return n.column()>=t.startCol()&&n.column()+n.colspan()-1<=t.finishCol()&&n.row()>=t.startRow()&&n.row()+n.rowspan()-1<=t.finishRow()},Fe=function(t,n){var e=n.column(),r=n.column()+n.colspan()-1,o=n.row(),i=n.row()+n.rowspan()-1;return e<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},je=function(t,n){for(var e=!0,r=u(Le,n),o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)e=e&&ge.getAt(t,o,i).exists(r);return e?p.some(n):p.none()},ze=function(t,n,e){var r=ge.findItem(t,n,hn),o=ge.findItem(t,e,hn);return r.bind((function(t){return o.map((function(n){return e=t,r=n,Vn(Math.min(e.row(),r.row()),Math.min(e.column(),r.column()),Math.max(e.row()+e.rowspan()-1,r.row()+r.rowspan()-1),Math.max(e.column()+e.colspan()-1,r.column()+r.colspan()-1));var e,r}))}))},He=ze,Ue=function(t,n,e){return ze(t,n,e).bind((function(n){return je(t,n)}))},qe=function(t,n,e,r){return ge.findItem(t,n,hn).bind((function(n){var o=e>0?n.row()+n.rowspan()-1:n.row(),i=r>0?n.column()+n.colspan()-1:n.column();return ge.getAt(t,o+e,i+r).map((function(t){return t.element()}))}))},Ve=function(t,n,e){return He(t,n,e).map((function(n){var e=ge.filterItems(t,u(Fe,n));return O(e,(function(t){return t.element()}))}))},Ge=function(t,n){return ge.findItem(t,n,(function(t,n){return pn(n,t)})).map((function(t){return t.element()}))},Ye=function(t){var n=fe(t);return ge.generate(n)},Xe=function(t,n,e){return ae(t).bind((function(r){var o=Ye(r);return qe(o,t,n,e)}))},Ke=function(t,n,e){var r=Ye(t);return Ve(r,n,e)},Je=function(t,n,e,r,o){var i=Ye(t),u=hn(t,e)?p.some(n):Ge(i,n),c=hn(t,o)?p.some(r):Ge(i,r);return u.bind((function(t){return c.bind((function(n){return Ve(i,t,n)}))}))},$e=function(t,n,e){var r=Ye(t);return Ue(r,n,e)},Qe=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Ze(){return{up:o({selector:Qn,closest:ne,predicate:$n,all:yn}),down:o({selector:Kn,predicate:Gn}),styles:o({get:Nt,getRaw:kt,set:Dt,remove:At}),attrs:o({get:mt,set:st,remove:ht,copyTo:function(t,n){var e=pt(t);dt(n,e)}}),insert:o({before:Tn,after:Dn,afterAll:kn,append:Nn,appendAll:An,prepend:On,wrap:En}),remove:o({unwrap:Bn,remove:In}),create:o({nu:xt.fromTag,clone:function(t){return xt.fromDom(t.dom().cloneNode(!1))},text:xt.fromText}),query:o({comparePosition:function(t,n){return t.dom().compareDocumentPosition(n.dom())},prevSibling:xn,nextSibling:Cn}),property:o({children:Rn,name:ot,parent:wn,document:function(t){return t.dom().ownerDocument},isText:lt,isComment:ct,isElement:at,getText:we,setText:xe,isBoundary:function(t){return!!at(t)&&("body"===ot(t)||T(Qe,ot(t)))},isEmptyTag:function(t){return!!at(t)&&T(["br","img","hr","input"],ot(t))}}),eq:hn,is:vn}}var tr=q("left","right"),nr=q("first","second","splits"),er=function(t,n,e){var r=t.property().children(n);return I(r,u(t.eq,e)).map((function(t){return{before:o(r.slice(0,t)),after:o(r.slice(t+1))}}))},rr=function(t,n,e,r){var o=n(t,e);return k(r,(function(e,r){var o=n(t,r);return or(t,e,o)}),o)},or=function(t,n,e){return n.bind((function(n){return e.filter(u(t.eq,n))}))},ir=function(t,n){return u(t.eq,n)},ur=function(t,n,e,r){void 0===r&&(r=l);var i=[n].concat(t.up().all(n)),u=[e].concat(t.up().all(e)),c=function(t){return I(t,r).fold((function(){return t}),(function(n){return t.slice(0,n+1)}))},a=c(i),f=c(u),s=P(a,(function(n){return D(f,ir(t,n))}));return{firstpath:o(a),secondpath:o(f),shared:o(s)}},cr=function(t,n,e){var r=ur(t,n,e);return r.shared().bind((function(n){return function(t,n,e,r){var o=t.property().children(n);if(t.eq(n,e[0]))return p.some([e[0]]);if(t.eq(n,r[0]))return p.some([r[0]]);var i=function(e){var r=F(e),i=I(r,ir(t,n)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return I(o,ir(t,u))},u=i(e),c=i(r);return u.bind((function(t){return c.map((function(n){var e=Math.min(t,n),r=Math.max(t,n);return o.slice(e,r+1)}))}))}(t,n,r.firstpath(),r.secondpath())}))},ar=function(t,n,e){return e.length>0?function(t,n,e,r){return r(t,n,e[0],e.slice(1))}(t,n,e,rr):p.none()},lr=function(t,n,e){return er(t,n,e).map((function(r){var o=t.create().clone(n);return t.insert().appendAll(o,r.before().concat([e])),t.insert().appendAll(n,r.after()),t.insert().before(n,o),tr(o,n)}))},fr=function(t,n,e){return er(t,n,e).map((function(e){var r=t.create().clone(n);return t.insert().appendAll(r,e.after()),t.insert().after(n,r),tr(n,r)}))},sr=function(t,n,e,r){var o=function(n,i,u){var c=nr(n,p.none(),u);return e(n)?nr(n,i,u):t.property().parent(n).bind((function(i){return r(t,i,n).map((function(t){var n=[{first:t.left,second:t.right}],r=e(i)?i:t.left();return o(r,p.some(t.right()),u.concat(n))}))})).getOr(c)};return o(n,p.none(),[])},dr={sharedOne:ar,subset:cr,ancestors:ur,breakToLeft:lr,breakToRight:fr,breakPath:sr},mr=Ze(),gr=function(t,n){return dr.sharedOne(mr,(function(n,e){return t(e)}),n)},hr=function(t,n,e){return dr.ancestors(mr,t,n,e)},pr={create:J(["boxes","start","finish"],[])},vr=function(t){return Qn(t,"table")},br=function(t,n,e){var r=function(t){return function(n){return void 0!==e&&e(n)||hn(n,t)}};return hn(t,n)?p.some(pr.create({boxes:p.some([t]),start:t,finish:n})):vr(t).bind((function(o){return vr(n).bind((function(i){if(hn(o,i))return p.some(pr.create({boxes:Ke(o,t,n),start:t,finish:n}));if(pn(o,i)){var u=(c=Yn(n,"td,th",r(o))).length>0?c[c.length-1]:n;return p.some(pr.create({boxes:Je(o,t,o,n,i),start:t,finish:u}))}if(pn(i,o)){var c,a=(c=Yn(t,"td,th",r(i))).length>0?c[c.length-1]:t;return p.some(pr.create({boxes:Je(i,t,o,n,i),start:t,finish:a}))}return hr(t,n).shared().bind((function(u){return ne(u,"table",e).bind((function(e){var u=Yn(n,"td,th",r(e)),c=u.length>0?u[u.length-1]:n,a=Yn(t,"td,th",r(e)),l=a.length>0?a[a.length-1]:t;return p.some(pr.create({boxes:Je(e,t,o,n,i),start:l,finish:c}))}))}))}))}))},wr=br,yr=function(t,n){var e=Kn(t,n);return e.length>0?p.some(e):p.none()},xr=function(t,n,e,r,i){return function(t,n){return P(t,(function(t){return mn(t,n)}))}(t,i).bind((function(t){return Xe(t,n,e).bind((function(t){return function(t,n){return Qn(t,"table").bind((function(e){return te(e,n).bind((function(n){return br(n,t).bind((function(t){return t.boxes().map((function(n){return{boxes:o(n),start:o(t.start()),finish:o(t.finish())}}))}))}))}))}(t,r)}))}))},Cr=function(t,n,e){return te(t,n).bind((function(n){return te(t,e).bind((function(t){return gr(vr,[n,t]).map((function(e){return{first:o(n),last:o(t),table:o(e)}}))}))}))},Rr=function(t,n){return yr(t,n)},Sr=function(t,n,e){return Cr(t,n,e).bind((function(n){var e=function(n){return hn(t,n)},r=Qn(n.first(),"thead,tfoot,tbody,table",e),o=Qn(n.last(),"thead,tfoot,tbody,table",e);return r.bind((function(t){return o.bind((function(e){return hn(t,e)?$e(n.table(),n.first(),n.last()):p.none()}))}))}))},Tr="data-mce-selected",Dr="data-mce-first-selected",Or="data-mce-last-selected",Nr={selected:o(Tr),selectedSelector:o("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:o("[data-mce-selected]"),firstSelected:o(Dr),firstSelectedSelector:o("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:o(Or),lastSelectedSelector:o("td[data-mce-last-selected],th[data-mce-last-selected]")},Er=function(n){if(!w(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],r={};return N(n,(function(o,i){var u=j(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!w(a))throw new Error("case arguments must be an array");e.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];var l=function(t){var n=j(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!L(e,(function(t){return T(n,t)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[c].apply(null,o)};return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);var t=arguments[i];return t.apply(null,o)},match:l,log:function(n){t.console.log(n,{constructors:e,constructor:c,params:o})}}}})),r},kr=Er([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Ar={cata:function(t,n,e,r){return t.fold(n,e,r)},none:kr.none,multiple:kr.multiple,single:kr.single},Pr=function(t,n){return Ar.cata(n.get(),o([]),i,o([t]))},Ir=function(t,n){return Ar.cata(n.get(),p.none,(function(n,e){return 0===n.length?p.none():Sr(t,Nr.firstSelectedSelector(),Nr.lastSelectedSelector()).bind((function(t){return n.length>1?p.some({bounds:o(t),cells:o(n)}):p.none()}))}),p.none)},Br=function(t,n){var e=Pr(t,n);return e.length>0&&L(e,(function(t){return gt(t,"rowspan")&&parseInt(mt(t,"rowspan"),10)>1||gt(t,"colspan")&&parseInt(mt(t,"colspan"),10)>1}))?p.some(e):p.none()},Wr=Pr,Mr=function(t){return{element:o(t),mergable:p.none,unmergable:p.none,selection:o([t])}},_r=q("element","clipboard","generators"),Lr={noMenu:Mr,forMenu:function(t,n,e){return{element:o(e),mergable:o(Ir(n,t)),unmergable:o(Br(e,t)),selection:o(Wr(e,t))}},notCell:function(t){return Mr(t)},paste:_r,pasteRows:function(t,n,e,r,i){return{element:o(e),mergable:p.none,unmergable:p.none,selection:o(Wr(e,t)),clipboard:o(r),generators:o(i)}}},Fr=function(n,r,o,i){n.on("BeforeGetContent",(function(t){!0===t.selection&&Ar.cata(r.get(),e,(function(e){t.preventDefault(),function(t){return ae(t[0]).map(ke).map((function(t){return[ve(t,Nr.attributeSelector())]}))}(e).each((function(e){t.content="text"===t.format?function(t){return O(t,(function(t){return t.dom().innerText})).join("")}(e):function(t,n){return O(n,(function(n){return t.selection.serializer.serialize(n.dom(),{})})).join("")}(n,e)}))}),e)})),n.on("BeforeSetContent",(function(e){!0===e.selection&&!0===e.paste&&p.from(n.dom.getParent(n.selection.getStart(),"th,td")).each((function(r){var u=xt.fromDom(r);ae(u).each((function(r){var c,a,l,f=E((c=e.content,(l=(a||t.document).createElement("div")).innerHTML=c,Rn(xt.fromDom(l))),(function(t){return"meta"!==ot(t)}));if(1===f.length&&"table"===ot(f[0])){e.preventDefault();var s=xt.fromDom(n.getDoc()),d=_e(s),m=Lr.paste(u,f[0],d);o.pasteCells(r,m).each((function(t){n.selection.setRng(t),n.focus(),i.clear(r)}))}}))}))}))};function jr(t,n){var e=function(e){var r=n(e);if(r<=0||null===r){var o=Nt(e,t);return parseFloat(o)||0}return r},r=function(t,n){return A(n,(function(n,e){var r=Nt(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o}),0)};return{set:function(n,e){if(!C(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var r=n.dom();bt(r)&&(r.style[t]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(t,n,e){var o=r(t,e);return n>o?n-o:0}}}var zr=jr("height",(function(t){var n=t.dom();return Ct(t)?n.getBoundingClientRect().height:n.offsetHeight})),Hr=function(t){return zr.get(t)},Ur=function(t){return zr.getOuter(t)},qr=jr("width",(function(t){return t.dom().offsetWidth})),Vr=function(t){return qr.get(t)},Gr=function(t){return qr.getOuter(t)},Yr=fn.detect(),Xr=function(t,n,e){return function(t,n){var e=parseFloat(t);return isNaN(e)?n:e}(Nt(t,n),e)},Kr=function(t){return Yr.browser.isIE()||Yr.browser.isEdge()?function(t){var n=Xr(t,"padding-top",0),e=Xr(t,"padding-bottom",0),r=Xr(t,"border-top-width",0),o=Xr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===Nt(t,"box-sizing")?i:i-n-e-(r+o)}(t):Xr(t,"height",Hr(t))},Jr=/(\d+(\.\d+)?)(\w|%)*/,$r=/(\d+(\.\d+)?)%/,Qr=/(\d+(\.\d+)?)px|em/,Zr=function(t,n){Dt(t,"height",n+"px")},to=function(t,n,e,r){var o,i,u=parseInt(t,10);return function(t,n,e){return""===n||!(t.length<n.length)&&t.substr(e,e+n.length)===n}(o=t,i="%",o.length-i.length)&&"table"!==ot(n)?function(t,n,e,r){var o=ae(t).map((function(t){var r=e(t);return Math.floor(n/100*r)})).getOr(n);return r(t,o),o}(n,u,e,r):u},no=function(t){var n=function(t){return kt(t,"height").getOrThunk((function(){return Kr(t)+"px"}))}(t);return n?to(n,t,Hr,Zr):Hr(t)},eo=function(t,n){return gt(t,n)?parseInt(mt(t,n),10):1},ro=function(t){return kt(t,"width").fold((function(){return p.from(mt(t,"width"))}),(function(t){return p.some(t)}))},oo=function(t,n){return t/n.pixelWidth()*100},io={percentageBasedSizeRegex:o($r),pixelBasedSizeRegex:o(Qr),setPixelWidth:function(t,n){Dt(t,"width",n+"px")},setPercentageWidth:function(t,n){Dt(t,"width",n+"%")},setHeight:Zr,getPixelWidth:function(t,n){return ro(t).fold((function(){return Vr(t)}),(function(e){return function(t,n,e){var r=Qr.exec(n);if(null!==r)return parseInt(r[1],10);var o=$r.exec(n);return null!==o?function(t,n){return t/100*n.pixelWidth()}(parseFloat(o[1]),e):Vr(t)}(t,e,n)}))},getPercentageWidth:function(t,n){return ro(t).fold((function(){var e=Vr(t);return oo(e,n)}),(function(e){return function(t,n,e){var r=$r.exec(n);if(null!==r)return parseFloat(r[1]);var o=Vr(t);return oo(o,e)}(t,e,n)}))},getGenericWidth:function(t){return ro(t).bind((function(t){var n=Jr.exec(t);return null!==n?p.some({width:o(parseFloat(n[1])),unit:o(n[3])}):p.none()}))},setGenericWidth:function(t,n,e){Dt(t,"width",n+e)},getHeight:function(t){return function(t,n,e){return e(t)/eo(t,n)}(t,"rowspan",no)},getRawWidth:ro},uo=function(t,n){io.getGenericWidth(t).each((function(e){var r=e.width()/2;io.setGenericWidth(t,r,e.unit()),io.setGenericWidth(n,r,e.unit())}))},co=function(t,n){return{left:o(t),top:o(n),translate:function(e,r){return co(t+e,n+r)}}},ao=co,lo=function(t,n){return void 0!==t?t:void 0!==n?n:0},fo=function(t){var n=t.dom().ownerDocument,e=n.body,r=n.defaultView,o=n.documentElement,i=lo(r.pageYOffset,o.scrollTop),u=lo(r.pageXOffset,o.scrollLeft),c=lo(o.clientTop,e.clientTop),a=lo(o.clientLeft,e.clientLeft);return so(t).translate(u-a,i-c)},so=function(t){var n=t.dom(),e=n.ownerDocument.body;return e===n?ao(e.offsetLeft,e.offsetTop):Ct(t)?function(t){var n=t.getBoundingClientRect();return ao(n.left,n.top)}(n):ao(0,0)},mo=q("row","y"),go=q("col","x"),ho=function(t){return fo(t).left()+Gr(t)},po=function(t){return fo(t).left()},vo=function(t,n){return go(t,po(n))},bo=function(t,n){return go(t,ho(n))},wo=function(t){return fo(t).top()},yo=function(t,n){return mo(t,wo(n))},xo=function(t,n){return mo(t,wo(n)+Ur(n))},Co=function(t,n,e){if(0===e.length)return[];var r=O(e.slice(1),(function(n,e){return n.map((function(n){return t(e,n)}))})),o=e[e.length-1].map((function(t){return n(e.length-1,t)}));return r.concat([o])},Ro={height:{delta:i,positions:function(t){return Co(yo,xo,t)},edge:wo},rtl:{delta:function(t){return-t},edge:ho,positions:function(t){return Co(bo,vo,t)}},ltr:{delta:i,edge:po,positions:function(t){return Co(vo,bo,t)}}},So={ltr:Ro.ltr,rtl:Ro.rtl};function To(t){var n=function(n){return t(n).isRtl()?So.rtl:So.ltr};return{delta:function(t,e){return n(e).delta(t,e)},edge:function(t){return n(t).edge(t)},positions:function(t,e){return n(e).positions(t,e)}}}var Do=function(t){var n=fe(t);return ge.generate(n).grid()},Oo=function(){return Oo=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},Oo.apply(this,arguments)},No=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},Eo=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return p.none()},ko=function(t,n,e,r){e===r?ht(t,n):st(t,n,e)},Ao=function(t,n){var e=[],r=[],i=function(n,o){n.length>0?function(n,o){var i=Zn(t,o).getOrThunk((function(){var n=xt.fromTag(o,bn(t).dom());return Nn(t,n),n}));Pn(i);var u=O(n,(function(t){t.isNew()&&e.push(t.element());var n=t.element();return Pn(n),N(t.cells(),(function(t){t.isNew()&&r.push(t.element()),ko(t.element(),"colspan",t.colspan(),1),ko(t.element(),"rowspan",t.rowspan(),1),Nn(n,t.element())})),n}));An(i,u)}(n,o):function(n){Zn(t,n).each(In)}(o)},u=[],c=[],a=[];return N(n,(function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":c.push(t);break;case"tfoot":a.push(t)}})),i(u,"thead"),i(c,"tbody"),i(a,"tfoot"),{newRows:o(e),newCells:o(r)}},Po=function(t){var n=O(t,(function(t){var n=Ee(t.element());return N(t.cells(),(function(t){var e=ke(t.element());ko(e,"colspan",t.colspan(),1),ko(e,"rowspan",t.rowspan(),1),Nn(n,e)})),n}));return n},Io=function(t,n){var e=mt(t,n);return void 0===e||""===e?[]:e.split(" ")},Bo=function(t){return void 0!==t.dom().classList},Wo=function(t,n){return function(t,n,e){var r=Io(t,n).concat([e]);return st(t,n,r.join(" ")),!0}(t,"class",n)},Mo=function(t,n){Bo(t)?t.dom().classList.add(n):Wo(t,n)},_o=function(t,n){return Bo(t)&&t.dom().classList.contains(n)},Lo=function(t,n){for(var e=[],r=t;r<n;r++)e.push(r);return e},Fo=function(t,n){if(n<0||n>=t.length-1)return p.none();var e=t[n].fold((function(){var e=F(t.slice(0,n));return Eo(e,(function(t,n){return t.map((function(t){return{value:t,delta:n+1}}))}))}),(function(t){return p.some({value:t,delta:0})})),r=t[n+1].fold((function(){var e=t.slice(n+1);return Eo(e,(function(t,n){return t.map((function(t){return{value:t,delta:n+1}}))}))}),(function(t){return p.some({value:t,delta:1})}));return e.bind((function(t){return r.map((function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e}))}))},jo=function(t,n,e){var r=t();return P(r,n).orThunk((function(){return p.from(r[0]).orThunk(e)})).map((function(t){return t.element()}))},zo=function(t){var n=t.grid(),e=Lo(0,n.columns()),r=Lo(0,n.rows());return O(e,(function(n){return jo((function(){return _(r,(function(e){return ge.getAt(t,e,n).filter((function(t){return t.column()===n})).fold(o([]),(function(t){return[t]}))}))}),(function(t){return 1===t.colspan()}),(function(){return ge.getAt(t,0,n)}))}))},Ho=function(t){var n=t.grid(),e=Lo(0,n.rows()),r=Lo(0,n.columns());return O(e,(function(n){return jo((function(){return _(r,(function(e){return ge.getAt(t,n,e).filter((function(t){return t.row()===n})).fold(o([]),(function(t){return[t]}))}))}),(function(t){return 1===t.rowspan()}),(function(){return ge.getAt(t,n,0)}))}))},Uo=function(t){var n=t.replace(/\./g,"-");return{resolve:function(t){return n+"-"+t}}},qo=Uo("ephox-snooker"),Vo={resolve:qo.resolve},Go=function(t,n,e,r,o){var i=xt.fromTag("div");return Ot(i,{position:"absolute",left:n-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),dt(i,{"data-column":t,role:"presentation"}),i},Yo=function(t,n,e,r,o){var i=xt.fromTag("div");return Ot(i,{position:"absolute",left:n+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),dt(i,{"data-row":t,role:"presentation"}),i},Xo=Vo.resolve("resizer-bar"),Ko=Vo.resolve("resizer-rows"),Jo=Vo.resolve("resizer-cols"),$o=function(t){var n=Kn(t.parent(),"."+Xo);N(n,In)},Qo=function(t,n,e){var r=t.origin();N(n,(function(n,o){n.each((function(n){var o=e(r,n);Mo(o,Xo),Nn(t.parent(),o)}))}))},Zo=function(t,n,e,r,o,i){var u=fo(n);!function(t,n,e,r){Qo(t,n,(function(t,n){var o=Yo(n.row(),e.left()-t.left(),n.y()-t.top(),r,7);return Mo(o,Ko),o}))}(t,e.length>0?o.positions(e,n):[],u,Gr(n)),function(t,n,e,r){Qo(t,n,(function(t,n){var o=Go(n.col(),n.x()-t.left(),e.top()-t.top(),7,r);return Mo(o,Jo),o}))}(t,r.length>0?i.positions(r,n):[],u,Ur(n))},ti=function(t,n){var e=Kn(t.parent(),"."+Xo);N(e,n)},ni=function(t,n,e,r){$o(t);var o=fe(n),i=ge.generate(o),u=Ho(i),c=zo(i);Zo(t,n,u,c,e,r)},ei=function(t){ti(t,(function(t){Dt(t,"display","none")}))},ri=function(t){ti(t,(function(t){Dt(t,"display","block")}))},oi=$o,ii=function(t){return _o(t,Ko)},ui=function(t){return _o(t,Jo)},ci=function(t,n){return Un(n,t.section())},ai=function(t,n){return t.cells()[n]},li={addCell:function(t,n,e){var r=t.cells(),o=r.slice(0,n),i=r.slice(n),u=o.concat([e]).concat(i);return ci(t,u)},setCells:ci,mutateCell:function(t,n,e){t.cells()[n]=e},getCell:ai,getCellElement:function(t,n){return ai(t,n).element()},mapCells:function(t,n){var e=t.cells(),r=O(e,n);return Un(r,t.section())},cellLength:function(t){return t.cells().length}},fi=function(t,n){if(0===t.length)return 0;var e=t[0];return I(t,(function(t){return!n(e.element(),t.element())})).fold((function(){return t.length}),(function(t){return t}))},si=function(t,n,e,r){var i=function(t,n){return t[n]}(t,n).cells().slice(e),u=fi(i,r),c=function(t,n){return O(t,(function(t){return li.getCell(t,n)}))}(t,e).slice(n),a=fi(c,r);return{colspan:o(u),rowspan:o(a)}},di=function(t,n){var e=O(t,(function(t,n){return O(t.cells(),(function(t,n){return!1}))}));return O(t,(function(r,o){var i=_(r.cells(),(function(r,i){if(!1===e[o][i]){var u=si(t,o,i,n);return function(t,n,r,o){for(var i=t;i<t+r;i++)for(var u=n;u<n+o;u++)e[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[Ln(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]}));return qn(i,r.section())}))},mi=function(t,n,e){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=ge.getAt(t,o,u).map((function(t){return zn(t.element(),e)})).getOrThunk((function(){return zn(n.gap(),!0)}));i.push(c)}var a=Un(i,t.all()[o].section());r.push(a)}return r},gi=function(t,n){return O(t,(function(t){var e=function(t){var e=Eo(t,(function(t){return wn(t.element()).map((function(t){var n=wn(t).isNone();return zn(t,n)}))}));return e.getOrThunk((function(){return zn(n.row(),!0)}))}(t.details());return Hn(e.element(),t.details(),t.section(),e.isNew())}))},hi=function(t,n){var e=di(t,hn);return gi(e,n)},pi=function(t,n){var e=M(O(t.all(),(function(t){return t.cells()})));return P(e,(function(t){return hn(n,t.element())}))},vi=function(t,n,e,r,i){return function(u,c,a,l,f){var s=fe(c),d=ge.generate(s),m=n(d,a).map((function(n){var e=function(t,n){return mi(t,n,!1)}(d,l),r=t(e,n,hn,i(l)),u=hi(r.grid(),l);return{grid:o(u),cursor:r.cursor}}));return m.fold((function(){return p.none()}),(function(t){var n=Ao(c,t.grid());return e(c,t.grid(),f),r(c),ni(u,c,Ro.height,f),p.some({cursor:t.cursor,newRows:n.newRows,newCells:n.newCells})}))}},bi=function(t,n){return ue(n.element()).bind((function(n){return pi(t,n)}))},wi=function(t,n){var e=O(n.selection(),(function(n){return ue(n).bind((function(n){return pi(t,n)}))})),r=No(e);return r.length>0?p.some({cells:r,generators:n.generators,clipboard:n.clipboard}):p.none()},yi=function(t,n){var e=O(n.selection(),(function(n){return ue(n).bind((function(n){return pi(t,n)}))})),r=No(e);return r.length>0?p.some(r):p.none()},xi=function(t){return{is:function(n){return t===n},isValue:f,isError:l,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:function(n){return xi(t)},orThunk:function(n){return xi(t)},fold:function(n,e){return e(t)},map:function(n){return xi(n(t))},mapError:function(n){return xi(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return p.some(t)}}},Ci=function(t){return{is:l,isValue:l,isError:f,getOr:i,getOrThunk:function(t){return t()},getOrDie:function(){return(n=String(t),function(){throw new Error(n)})();var n},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return Ci(t)},mapError:function(n){return Ci(n(t))},each:e,bind:function(n){return Ci(t)},exists:l,forall:f,toOption:p.none}},Ri={value:xi,error:Ci,fromOption:function(t,n){return t.fold((function(){return Ci(n)}),xi)}},Si=function(t,n){return O(t,(function(){return zn(n.cell(),!0)}))},Ti=function(t,n,e){return t.concat(function(t,n){for(var e=[],r=0;r<t;r++)e.push(n(r));return e}(n,(function(n){return li.setCells(t[t.length-1],Si(t[t.length-1].cells(),e))})))},Di=function(t,n,e){return O(t,(function(t){return li.setCells(t,t.cells().concat(Si(Lo(0,n),e)))}))},Oi=function(t,n,e){if(t.row()>=n.length||t.column()>li.cellLength(n[0]))return Ri.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=n.slice(t.row()),i=r[0].cells().slice(t.column()),u=li.cellLength(e[0]),c=e.length;return Ri.value({rowDelta:o(r.length-c),colDelta:o(i.length-u)})},Ni=function(t,n){var e=li.cellLength(t[0]),r=li.cellLength(n[0]);return{rowDelta:o(0),colDelta:o(e-r)}},Ei=function(t,n,e){var r=n.colDelta()<0?Di:i;return(n.rowDelta()<0?Ti:i)(r(t,Math.abs(n.colDelta()),e),Math.abs(n.rowDelta()),e)},ki=function(t,n,e,r){if(0===t.length)return t;for(var o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)li.mutateCell(t[o],i,zn(r(),!1));return t},Ai=function(t,n,e,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<li.cellLength(t[0]);u++){var c=e(li.getCellElement(t[i],u),n);!0===c&&!1===o?li.mutateCell(t[i],u,zn(r(),!0)):!0===c&&(o=!1)}return t},Pi=function(t,n,e,r){if(n>0&&n<t.length){var o=function(t,n){return A(t,(function(t,e){return D(t,(function(t){return n(t.element(),e.element())}))?t:t.concat([e])}),[])}(t[n-1].cells(),e);N(o,(function(o){for(var i=p.none(),u=function(n){for(var u=function(u){var c=t[n].cells()[u];e(c.element(),o.element())&&(i.isNone()&&(i=p.some(r())),i.each((function(e){li.mutateCell(t[n],u,zn(e,!0))})))},c=0;c<li.cellLength(t[0]);c++)u(c)},c=n;c<t.length;c++)u(c)}))}return t},Ii=function(t,n,e,r){var o=u(r,li.getCell(t[n],e).element()),i=t[n];return t.length>1&&li.cellLength(i)>1&&(e>0&&o(li.getCellElement(i,e-1))||e<i.cells().length-1&&o(li.getCellElement(i,e+1))||n>0&&o(li.getCellElement(t[n-1],e))||n<t.length-1&&o(li.getCellElement(t[n+1],e)))},Bi=function(t,n,e,r,o){return Oi(t,n,e).map((function(i){var u=Ei(n,i,r);return function(t,n,e,r,o){for(var i=t.row(),u=t.column(),c=i+e.length,a=u+li.cellLength(e[0]),l=i;l<c;l++)for(var f=u;f<a;f++){Ii(n,l,f,o)&&Ai(n,li.getCellElement(n[l],f),o,r.cell);var s=li.getCellElement(e[l-i],f-u),d=r.replace(s);li.mutateCell(n[l],f,zn(d,!0))}return n}(t,u,e,r,o)}))},Wi=function(t,n,e,r,o){Pi(n,t,o,r.cell);var i=Ni(e,n),u=Ei(e,i,r),c=Ni(n,u),a=Ei(n,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},Mi=function(t,n,e,r,o){var i=t.slice(0,n),u=t.slice(n),c=li.mapCells(t[e],(function(e,i){return n>0&&n<t.length&&r(li.getCellElement(t[n-1],i),li.getCellElement(t[n],i))?li.getCell(t[n],i):zn(o(e.element(),r),!0)}));return i.concat([c]).concat(u)},_i=function(t,n,e,r,o){return O(t,(function(t){var i=n>0&&n<li.cellLength(t)&&r(li.getCellElement(t,n-1),li.getCellElement(t,n))?li.getCell(t,n):zn(o(li.getCellElement(t,e),r),!0);return li.addCell(t,n,i)}))},Li=function(t,n,e,r,o){var i=e+1;return O(t,(function(t,u){var c=u===n?zn(o(li.getCellElement(t,e),r),!0):li.getCell(t,e);return li.addCell(t,i,c)}))},Fi=function(t,n,e,r,o){var i=n+1,u=t.slice(0,i),c=t.slice(i),a=li.mapCells(t[n],(function(t,n){return n===e?zn(o(t.element(),r),!0):t}));return u.concat([a]).concat(c)},ji=function(t,n,e){return t.slice(0,n).concat(t.slice(e+1))},zi=function(t,n,e){var r=O(t,(function(t){var r=t.cells().slice(0,n).concat(t.cells().slice(e+1));return Un(r,t.section())}));return E(r,(function(t){return t.cells().length>0}))},Hi=function(t,n,e,r){return O(t,(function(t){return li.mapCells(t,(function(t){return function(t){return D(n,(function(n){return e(t.element(),n.element())}))}(t)?zn(r(t.element(),e),!0):t}))}))},Ui=function(t,n,e,r){return void 0!==li.getCellElement(t[n],e)&&n>0&&r(li.getCellElement(t[n-1],e),li.getCellElement(t[n],e))},qi=function(t,n,e){return n>0&&e(li.getCellElement(t,n-1),li.getCellElement(t,n))},Vi=function(t,n,e,r){var o=_(t,(function(r,o){return Ui(t,o,n,e)||qi(r,n,e)?[]:[li.getCell(r,n)]}));return Hi(t,o,e,r)},Gi=function(t,n,e,r){var o=t[n],i=_(o.cells(),(function(r,i){return Ui(t,n,i,e)||qi(o,i,e)?[]:[r]}));return Hi(t,i,e,r)},Yi=Er([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Xi=Oo({},Yi),Ki=function(t,n,e,r){var i=t.slice(0),u=function(t,n){return 0===t.length?Xi.none():1===t.length?Xi.only(0):0===n?Xi.left(0,1):n===t.length-1?Xi.right(n-1,n):n>0&&n<t.length-1?Xi.middle(n-1,n,n+1):Xi.none()}(t,n),c=function(t){return O(t,o(0))},a=o(c(i)),l=function(t,n){if(e>=0){var o=Math.max(r.minCellWidth(),i[n]-e);return c(i.slice(0,t)).concat([e,o-i[n]]).concat(c(i.slice(n+1)))}var u=Math.max(r.minCellWidth(),i[t]+e),a=i[t]-u;return c(i.slice(0,t)).concat([u-i[t],a]).concat(c(i.slice(n+1)))},f=l;return u.fold(a,(function(t){return r.singleColumnWidth(i[t],e)}),f,(function(t,n,e){return l(n,e)}),(function(t,n){if(e>=0)return c(i.slice(0,n)).concat([e]);var o=Math.max(r.minCellWidth(),i[n]+e);return c(i.slice(0,n)).concat([o-i[n]])}))},Ji=function(t,n){return gt(t,n)&&parseInt(mt(t,n),10)>1},$i={hasColspan:function(t){return Ji(t,"colspan")},hasRowspan:function(t){return Ji(t,"rowspan")},minWidth:o(10),minHeight:o(10),getInt:function(t,n){return parseInt(Nt(t,n),10)}},Qi=function(t,n,e){return kt(t,n).fold((function(){return e(t)+"px"}),(function(t){return t}))},Zi=function(t,n){return Qi(t,"width",(function(t){return io.getPixelWidth(t,n)}))},tu=function(t){return Qi(t,"height",io.getHeight)},nu=function(t,n,e,r,o){var i=zo(t),u=O(i,(function(t){return t.map(n.edge)}));return O(i,(function(t,n){return t.filter(a($i.hasColspan)).fold((function(){var t=Fo(u,n);return r(t)}),(function(t){return e(t,o)}))}))},eu=function(t){return t.map((function(t){return t+"px"})).getOr("")},ru=function(t,n,e,r){var o=Ho(t),i=O(o,(function(t){return t.map(n.edge)}));return O(o,(function(t,n){return t.filter(a($i.hasRowspan)).fold((function(){var t=Fo(i,n);return r(t)}),(function(t){return e(t)}))}))},ou={getRawWidths:function(t,n,e){return nu(t,n,Zi,eu,e)},getPixelWidths:function(t,n,e){return nu(t,n,io.getPixelWidth,(function(t){return t.getOrThunk(e.minCellWidth)}),e)},getPercentageWidths:function(t,n,e){return nu(t,n,io.getPercentageWidth,(function(t){return t.fold((function(){return e.minCellWidth()}),(function(t){return t/e.pixelWidth()*100}))}),e)},getPixelHeights:function(t,n){return ru(t,n,io.getHeight,(function(t){return t.getOrThunk($i.minHeight)}))},getRawHeights:function(t,n){return ru(t,n,tu,eu)}},iu=function(t,n,e){for(var r=0,o=t;o<n;o++)r+=void 0!==e[o]?e[o]:0;return r},uu=function(t,n){var e=ge.justCells(t);return O(e,(function(t){var e=iu(t.column(),t.column()+t.colspan(),n);return{element:t.element,width:o(e),colspan:t.colspan}}))},cu=function(t,n){var e=ge.justCells(t);return O(e,(function(t){var e=iu(t.row(),t.row()+t.rowspan(),n);return{element:t.element,height:o(e),rowspan:t.rowspan}}))},au=function(t,n){return O(t.all(),(function(t,e){return{element:t.element,height:o(n[e])}}))},lu=function(t){var n=i;return{width:o(t),pixelWidth:o(t),getWidths:ou.getPixelWidths,getCellDelta:n,singleColumnWidth:function(t,n){return[Math.max($i.minWidth(),t+n)-t]},minCellWidth:$i.minWidth,setElementWidth:io.setPixelWidth,setTableWidth:function(t,n,e){var r=k(n,(function(t,n){return t+n}),0);io.setPixelWidth(t,r)}}},fu=function(t,n){var e=io.percentageBasedSizeRegex().exec(n);if(null!==e)return function(t,n){var e=parseFloat(t),r=Vr(n);return{width:o(e),pixelWidth:o(r),getWidths:ou.getPercentageWidths,getCellDelta:function(t){return t/r*100},singleColumnWidth:function(t,n){return[100-t]},minCellWidth:function(){return $i.minWidth()/r*100},setElementWidth:io.setPercentageWidth,setTableWidth:function(t,n,r){var o=r/100*e;io.setPercentageWidth(t,e+o)}}}(e[1],t);var r=io.pixelBasedSizeRegex().exec(n);if(null!==r){var i=parseInt(r[1],10);return lu(i)}var u=Vr(t);return lu(u)},su=function(t){return io.getRawWidth(t).fold((function(){var n=Vr(t);return lu(n)}),(function(n){return fu(t,n)}))},du=function(t){return ge.generate(t)},mu=function(t){var n=fe(t);return du(n)},gu=function(t,n,e,r){var o=su(t),i=o.getCellDelta(n),u=mu(t),c=o.getWidths(u,r,o),a=Ki(c,e,i,o),l=O(a,(function(t,n){return t+c[n]})),f=uu(u,l);N(f,(function(t){o.setElementWidth(t.element(),t.width())})),e===u.grid().columns()-1&&o.setTableWidth(t,l,i)},hu=function(t,n,e,r){var o=mu(t),i=ou.getPixelHeights(o,r),u=O(i,(function(t,r){return e===r?Math.max(n+t,$i.minHeight()):t})),c=cu(o,u),a=au(o,u);N(a,(function(t){io.setHeight(t.element(),t.height())})),N(c,(function(t){io.setHeight(t.element(),t.height())}));var l=k(u,(function(t,n){return t+n}),0);io.setHeight(t,l)},pu=function(t,n,e){var r=su(t),o=du(n),i=r.getWidths(o,e,r),u=uu(o,i);N(u,(function(t){r.setElementWidth(t.element(),t.width())})),u.length>0&&r.setTableWidth(t,i,r.getCellDelta(0))},vu=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return vu(e())}}},bu=function(t,n,e){if(0===n.length)throw new Error("You must specify at least one required field.");return X("required",n),K(n),function(r){var o=j(r);L(n,(function(t){return T(o,t)}))||G(n,o),t(n,o);var i=E(n,(function(t){return!e.validate(r[t],t)}));return i.length>0&&function(t,n){throw new Error("All values need to be of type: "+n+". Keys ("+V(t).join(", ")+") were not.")}(i,e.label),r}},wu=function(t,n){var e=E(n,(function(n){return!T(t,n)}));e.length>0&&Y(e)},yu=function(t){return function(t,n){return bu(t,n,{validate:x,label:"function"})}(wu,t)},xu=yu(["cell","row","replace","gap"]),Cu=function(t){var n=gt(t,"colspan")?parseInt(mt(t,"colspan"),10):1,e=gt(t,"rowspan")?parseInt(mt(t,"rowspan"),10):1;return{element:o(t),colspan:o(n),rowspan:o(e)}},Ru=function(t,n){void 0===n&&(n=Cu),xu(t);var e=vu(p.none()),r=function(e){return function(n){return t.cell(n)}(n(e))},o=function(t){var n=r(t);return e.get().isNone()&&e.set(p.some(n)),i=p.some({item:t,replacement:n}),n},i=p.none();return{getOrInit:function(t,n){return i.fold((function(){return o(t)}),(function(e){return n(t,e.item)?e.replacement:o(t)}))},cursor:e.get}},Su=function(t,n){return function(e){var r=vu(p.none());xu(e);var o=[],i=function(i){var u={scope:t},c=e.replace(i,n,u);return o.push({item:i,sub:c}),r.get().isNone()&&r.set(p.some(c)),c};return{replaceOrInit:function(t,n){return function(t,n){return P(o,(function(e){return n(e.item,t)}))}(t,n).fold((function(){return i(t)}),(function(e){return n(t,e.item)?e.sub:i(t)}))},cursor:r.get}}},Tu=function(t){xu(t);var n=vu(p.none());return{combine:function(e){return n.get().isNone()&&n.set(p.some(e)),function(){var n=t.cell({element:o(e),colspan:o(1),rowspan:o(1)});return At(n,"width"),At(e,"width"),n}},cursor:n.get}},Du=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Ou=function(t,n){var e=t.property().name(n);return T(Du,e)},Nu=function(t,n){return T(["br","img","hr","input"],t.property().name(n))},Eu=Ou,ku=function(t,n){var e=t.property().name(n);return T(["ol","ul"],e)},Au=Nu,Pu=Ze(),Iu=function(t){return Eu(Pu,t)},Bu=function(t){return ku(Pu,t)},Wu=function(t){return Au(Pu,t)},Mu=function(t){var n,e=function(t){return"br"===ot(t)},r=function(t){return De(t).bind((function(n){var r=Cn(n).map((function(t){return!!Iu(t)||!!Wu(t)&&"img"!==ot(t)})).getOr(!1);return wn(n).map((function(o){return!0===r||function(t){return"li"===ot(t)||$n(t,Bu).isSome()}(o)||e(n)||Iu(o)&&!hn(t,o)?[]:[xt.fromTag("br")]}))})).getOr([])},o=(n=_(t,(function(t){var n=Rn(t);return function(t){return L(t,(function(t){return e(t)||lt(t)&&0===we(t).trim().length}))}(n)?[]:n.concat(r(t))})),0===n.length?[xt.fromTag("br")]:n);Pn(t[0]),An(t[0],o)},_u=function(t){0===ce(t).length&&In(t)},Lu=q("grid","cursor"),Fu=function(t,n,e){return ju(t,n,e).orThunk((function(){return ju(t,0,0)}))},ju=function(t,n,e){return p.from(t[n]).bind((function(t){return p.from(t.cells()[e]).bind((function(t){return p.from(t.element())}))}))},zu=function(t,n,e){return Lu(t,ju(t,n,e))},Hu=function(t){return A(t,(function(t,n){return D(t,(function(t){return t.row()===n.row()}))?t:t.concat([n])}),[]).sort((function(t,n){return t.row()-n.row()}))},Uu=function(t){return A(t,(function(t,n){return D(t,(function(t){return t.column()===n.column()}))?t:t.concat([n])}),[]).sort((function(t,n){return t.column()-n.column()}))},qu=function(t,n,e){var r=se(t,e),o=ge.generate(r);return mi(o,n,!0)},Vu=pu,Gu={insertRowBefore:vi((function(t,n,e,r){var o=n.row(),i=n.row(),u=Mi(t,i,o,e,r.getOrInit);return zu(u,i,n.column())}),bi,e,e,Ru),insertRowsBefore:vi((function(t,n,e,r){var o=n[0].row(),i=n[0].row(),u=Hu(n),c=A(u,(function(t,n){return Mi(t,i,o,e,r.getOrInit)}),t);return zu(c,i,n[0].column())}),yi,e,e,Ru),insertRowAfter:vi((function(t,n,e,r){var o=n.row(),i=n.row()+n.rowspan(),u=Mi(t,i,o,e,r.getOrInit);return zu(u,i,n.column())}),bi,e,e,Ru),insertRowsAfter:vi((function(t,n,e,r){var o=Hu(n),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),c=A(o,(function(t,n){return Mi(t,u,i,e,r.getOrInit)}),t);return zu(c,u,n[0].column())}),yi,e,e,Ru),insertColumnBefore:vi((function(t,n,e,r){var o=n.column(),i=n.column(),u=_i(t,i,o,e,r.getOrInit);return zu(u,n.row(),i)}),bi,Vu,e,Ru),insertColumnsBefore:vi((function(t,n,e,r){var o=Uu(n),i=o[0].column(),u=o[0].column(),c=A(o,(function(t,n){return _i(t,u,i,e,r.getOrInit)}),t);return zu(c,n[0].row(),u)}),yi,Vu,e,Ru),insertColumnAfter:vi((function(t,n,e,r){var o=n.column(),i=n.column()+n.colspan(),u=_i(t,i,o,e,r.getOrInit);return zu(u,n.row(),i)}),bi,Vu,e,Ru),insertColumnsAfter:vi((function(t,n,e,r){var o=n[n.length-1].column(),i=n[n.length-1].column()+n[n.length-1].colspan(),u=Uu(n),c=A(u,(function(t,n){return _i(t,i,o,e,r.getOrInit)}),t);return zu(c,n[0].row(),i)}),yi,Vu,e,Ru),splitCellIntoColumns:vi((function(t,n,e,r){var o=Li(t,n.row(),n.column(),e,r.getOrInit);return zu(o,n.row(),n.column())}),bi,Vu,e,Ru),splitCellIntoRows:vi((function(t,n,e,r){var o=Fi(t,n.row(),n.column(),e,r.getOrInit);return zu(o,n.row(),n.column())}),bi,e,e,Ru),eraseColumns:vi((function(t,n,e,r){var o=Uu(n),i=zi(t,o[0].column(),o[o.length-1].column()),u=Fu(i,n[0].row(),n[0].column());return Lu(i,u)}),yi,Vu,_u,Ru),eraseRows:vi((function(t,n,e,r){var o=Hu(n),i=ji(t,o[0].row(),o[o.length-1].row()),u=Fu(i,n[0].row(),n[0].column());return Lu(i,u)}),yi,e,_u,Ru),makeColumnHeader:vi((function(t,n,e,r){var o=Vi(t,n.column(),e,r.replaceOrInit);return zu(o,n.row(),n.column())}),bi,e,e,Su("row","th")),unmakeColumnHeader:vi((function(t,n,e,r){var o=Vi(t,n.column(),e,r.replaceOrInit);return zu(o,n.row(),n.column())}),bi,e,e,Su(null,"td")),makeRowHeader:vi((function(t,n,e,r){var o=Gi(t,n.row(),e,r.replaceOrInit);return zu(o,n.row(),n.column())}),bi,e,e,Su("col","th")),unmakeRowHeader:vi((function(t,n,e,r){var o=Gi(t,n.row(),e,r.replaceOrInit);return zu(o,n.row(),n.column())}),bi,e,e,Su(null,"td")),mergeCells:vi((function(t,n,e,r){var i=n.cells();Mu(i);var u=ki(t,n.bounds(),e,o(i[0]));return Lu(u,p.from(i[0]))}),(function(t,n){return n.mergable()}),e,e,Tu),unmergeCells:vi((function(t,n,e,r){var o=k(n,(function(t,n){return Ai(t,n,e,r.combine(n))}),t);return Lu(o,p.from(n[0]))}),(function(t,n){return n.unmergable()}),Vu,e,Tu),pasteCells:vi((function(t,n,e,r){var o=function(t,n){var e=fe(t),r=ge.generate(e);return mi(r,n,!0)}(n.clipboard(),n.generators()),i=Mn(n.row(),n.column());return Bi(i,t,o,n.generators(),e).fold((function(){return Lu(t,p.some(n.element()))}),(function(t){var e=Fu(t,n.row(),n.column());return Lu(t,e)}))}),(function(t,n){return ue(n.element()).bind((function(e){return pi(t,e).map((function(t){return Oo({},t,{generators:n.generators,clipboard:n.clipboard})}))}))}),Vu,e,Ru),pasteRowsBefore:vi((function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[0].row(),u=qu(n.clipboard(),n.generators(),o),c=Wi(i,t,u,n.generators(),e),a=Fu(c,n.cells[0].row(),n.cells[0].column());return Lu(c,a)}),wi,e,e,Ru),pasteRowsAfter:vi((function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[n.cells.length-1].row()+n.cells[n.cells.length-1].rowspan(),u=qu(n.clipboard(),n.generators(),o),c=Wi(i,t,u,n.generators(),e),a=Fu(c,n.cells[0].row(),n.cells[0].column());return Lu(c,a)}),wi,e,e,Ru)},Yu=function(t){return xt.fromDom(t.getBody())},Xu=function(t){return t.getBoundingClientRect().width},Ku=function(t){return t.getBoundingClientRect().height},Ju=function(t){return function(n){return hn(n,Yu(t))}},$u=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Qu=function(t){var n=Kn(t,"td[data-mce-style],th[data-mce-style]");ht(t,"data-mce-style"),N(n,(function(t){ht(t,"data-mce-style")}))},Zu={isRtl:o(!1)},tc={isRtl:o(!0)},nc=function(t){var n=function(t){return"rtl"===Nt(t,"direction")?"rtl":"ltr"}(t);return"rtl"===n?tc:Zu},ec=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],rc={"border-collapse":"collapse",width:"100%"},oc={border:"1"},ic=function(t){return t.getParam("table_default_attributes",oc,"object")},uc=function(t){return t.getParam("table_default_styles",rc,"object")},cc=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},ac=function(t){return t.getParam("table_row_advtab",!0,"boolean")},lc=function(t){return t.getParam("table_advtab",!0,"boolean")},fc=function(t){return t.getParam("table_appearance_options",!0,"boolean")},sc=function(t){return t.getParam("table_style_by_css",!1,"boolean")},dc=function(t){return t.getParam("table_cell_class_list",[],"array")},mc=function(t){return t.getParam("table_row_class_list",[],"array")},gc=function(t){return t.getParam("table_class_list",[],"array")},hc=function(t){return!1===t.getParam("table_responsive_width")},pc=function(t,n){return t.fire("newrow",{node:n})},vc=function(t,n){return t.fire("newcell",{node:n})},bc=function(t,n,e,r){t.fire("ObjectResizeStart",{target:n,width:e,height:r})},wc=function(t,n,e,r){t.fire("ObjectResized",{target:n,width:e,height:r})},yc=function(t,n){var r=function(t){return"table"===ot(Yu(t))},o=function(t){var n=t.getParam("table_clone_elements");return b(n)?p.some(n.split(/[ ,]/)):Array.isArray(n)?p.some(n):p.none()}(t),i=function(n,e,r,i){return function(u,c){Qu(u);var a=i(),l=xt.fromDom(t.getDoc()),f=To(nc),s=Me(r,l,o);return e(u)?n(a,u,c,s,f).bind((function(n){return N(n.newRows(),(function(n){pc(t,n.dom())})),N(n.newCells(),(function(n){vc(t,n.dom())})),n.cursor().map((function(n){var e=t.dom.createRng();return e.setStart(n.dom(),0),e.setEnd(n.dom(),0),e}))})):p.none()}},u=i(Gu.eraseRows,(function(n){var e=Do(n);return!1===r(t)||e.rows()>1}),e,n),c=i(Gu.eraseColumns,(function(n){var e=Do(n);return!1===r(t)||e.columns()>1}),e,n);return{deleteRow:u,deleteColumn:c,insertRowsBefore:i(Gu.insertRowsBefore,f,e,n),insertRowsAfter:i(Gu.insertRowsAfter,f,e,n),insertColumnsBefore:i(Gu.insertColumnsBefore,f,uo,n),insertColumnsAfter:i(Gu.insertColumnsAfter,f,uo,n),mergeCells:i(Gu.mergeCells,f,e,n),unmergeCells:i(Gu.unmergeCells,f,e,n),pasteRowsBefore:i(Gu.pasteRowsBefore,f,e,n),pasteRowsAfter:i(Gu.pasteRowsAfter,f,e,n),pasteCells:i(Gu.pasteCells,f,e,n)}},xc=function(t,n,e){var r=fe(t),o=ge.generate(r);return yi(o,n).map((function(t){var n=mi(o,e,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=hi(n,e);return Po(r)}))},Cc=tinymce.util.Tools.resolve("tinymce.util.Tools"),Rc=function(t,n,e){e&&t.formatter.apply("align"+e,{},n)},Sc=function(t,n,e){e&&t.formatter.apply("valign"+e,{},n)},Tc=function(t,n){Cc.each("left center right".split(" "),(function(e){t.formatter.remove("align"+e,{},n)}))},Dc=function(t,n){Cc.each("top middle bottom".split(" "),(function(e){t.formatter.remove("valign"+e,{},n)}))},Oc=function(t,n,e){var r;return r=function(n,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],e);if(void 0===n&&(n=i),n!==i)return""}return n}(r,t.select("td,th",n))},Nc=function(t,n){var e=t.dom,r=n.control.rootControl,o=r.toJSON(),i=e.parseStyle(o.style);i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?$u(o.width):"",i.height=o.height?$u(o.height):"",r.find("#style").value(e.serializeStyle(e.parseStyle(e.serializeStyle(i))))},Ec=function(t,n){var e=t.dom,r=n.control.rootControl,o=r.toJSON(),i=e.parseStyle(o.style);r.find("#borderStyle").value(i["border-style"]||""),r.find("#borderColor").value(i["border-color"]||""),r.find("#backgroundColor").value(i["background-color"]||""),r.find("#width").value(i.width||""),r.find("#height").value(i.height||"")},kc={createStyleForm:function(t){var n=function(){var n=function(t){return t.getParam("color_picker_callback")}(t);if(n)return function(e){return n.call(t,(function(t){e.control.value(t).fire("change")}),e.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:u(Nc,t)},items:[{label:"Style",name:"style",type:"textbox",onchange:u(Ec,t)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:u(Nc,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:n()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:n()}]}]}},buildListItems:function(t,n,e){var r=function(t,e){return e=e||[],Cc.each(t,(function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,n&&n(o)),e.push(o)})),e};return r(t,e||[])},updateStyleField:Nc,extractAdvancedStyles:function(t,n){var e=t.parseStyle(t.getAttrib(n,"style")),r={};return e["border-style"]&&(r.borderStyle=e["border-style"]),e["border-color"]&&(r.borderColor=e["border-color"]),e["background-color"]&&(r.backgroundColor=e["background-color"]),r.style=t.serializeStyle(e),r},updateAdvancedFields:Ec,syncAdvancedStyleFields:function(n,e){e.control.rootControl.find("#style")[0].getEl().isEqualNode(t.document.activeElement)?Ec(n,e):Nc(n,e)}},Ac=function(t,n,e){var r,o=t.dom;function i(t,e,r){(1===n.length||r)&&o.setAttrib(t,e,r)}function u(t,e,r){(1===n.length||r)&&o.setStyle(t,e,r)}cc(t)&&kc.syncAdvancedStyleFields(t,e),r=e.control.rootControl.toJSON(),t.undoManager.transact((function(){Cc.each(n,(function(e){var c,a;i(e,"scope",r.scope),1===n.length?i(e,"style",r.style):(c=e,a=r.style,delete c.dataset.mceStyle,c.style.cssText+=";"+a),i(e,"class",r.class),u(e,"width",$u(r.width)),u(e,"height",$u(r.height)),r.type&&e.nodeName.toLowerCase()!==r.type&&(e=o.rename(e,r.type)),1===n.length&&(Tc(t,e),Dc(t,e)),r.align&&Rc(t,e,r.align),r.valign&&Sc(t,e,r.valign)})),t.focus()}))},Pc=function(t){var n,e,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&n&&o.push(n),n=n||o[0]){e=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:n.nodeName.toLowerCase()}:function(t,n){var e=t.dom,r={width:e.getStyle(n,"width")||e.getAttrib(n,"width"),height:e.getStyle(n,"height")||e.getAttrib(n,"height"),scope:e.getAttrib(n,"scope"),class:e.getAttrib(n,"class"),type:n.nodeName.toLowerCase(),style:"",align:"",valign:""};return Cc.each("left center right".split(" "),(function(e){t.formatter.matchNode(n,"align"+e)&&(r.align=e)})),Cc.each("top middle bottom".split(" "),(function(e){t.formatter.matchNode(n,"valign"+e)&&(r.valign=e)})),cc(t)&&Cc.extend(r,kc.extractAdvancedStyles(e,n)),r}(t,n),dc(t).length>0&&(r={name:"class",type:"listbox",label:"Class",values:kc.buildListItems(dc(t),(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[n.value]})})}))});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:u(kc.updateStyleField,t)},{label:"Height",name:"height",onchange:u(kc.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};cc(t)?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:e,body:[{title:"General",type:"form",items:i},kc.createStyleForm(t)],onsubmit:u(Ac,t,o)}):t.windowManager.open({title:"Cell properties",data:e,body:i,onsubmit:u(Ac,t,o)})}};function Ic(t,n,e,r){var o=t.dom;function i(t,e,r){(1===n.length||r)&&o.setAttrib(t,e,r)}ac(t)&&kc.syncAdvancedStyleFields(t,r);var u=r.control.rootControl.toJSON();t.undoManager.transact((function(){Cc.each(n,(function(r){i(r,"scope",u.scope),i(r,"style",u.style),i(r,"class",u.class),function(t,e,r){(1===n.length||r)&&o.setStyle(t,e,r)}(r,"height",$u(u.height)),u.type!==r.parentNode.nodeName.toLowerCase()&&function(t,n,e){var r=t.getParent(n,"table"),o=n.parentNode,i=t.select(e,r)[0];i||(i=t.create(e),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(n),o.hasChildNodes()||t.remove(o)}(t.dom,r,u.type),u.align!==e.align&&(Tc(t,r),Rc(t,r,u.align))})),t.focus()}))}var Bc=function(t){var n,e,r,o,i,c,a=t.dom,l=[];n=a.getParent(t.selection.getStart(),"table"),e=a.getParent(t.selection.getStart(),"td,th"),Cc.each(n.rows,(function(t){Cc.each(t.cells,(function(n){if(a.getAttrib(n,"data-mce-selected")||n===e)return l.push(t),!1}))})),(r=l[0])&&(i=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:function(t,n){var e=t.dom,r={height:e.getStyle(n,"height")||e.getAttrib(n,"height"),scope:e.getAttrib(n,"scope"),class:e.getAttrib(n,"class"),align:"",style:"",type:n.parentNode.nodeName.toLowerCase()};return Cc.each("left center right".split(" "),(function(e){t.formatter.matchNode(n,"align"+e)&&(r.align=e)})),ac(t)&&Cc.extend(r,kc.extractAdvancedStyles(e,n)),r}(t,r),mc(t).length>0&&(o={name:"class",type:"listbox",label:"Class",values:kc.buildListItems(mc(t),(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})}))}),c={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},ac(t)?t.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},kc.createStyleForm(t)],onsubmit:u(Ic,t,l,i)}):t.windowManager.open({title:"Row properties",data:i,body:c,onsubmit:u(Ic,t,l,i)}))},Wc=tinymce.util.Tools.resolve("tinymce.Env"),Mc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},_c=function(t,n,e,r,o){void 0===o&&(o=Mc);var i=xt.fromTag("table");Ot(i,o.styles),dt(i,o.attributes);var u=xt.fromTag("tbody");Nn(i,u);for(var c=[],a=0;a<t;a++){for(var l=xt.fromTag("tr"),f=0;f<n;f++){var s=a<e||f<r?xt.fromTag("th"):xt.fromTag("td");f<r&&st(s,"scope","row"),a<e&&st(s,"scope","col"),Nn(s,xt.fromTag("br")),o.percentages&&Dt(s,"width",100/n+"%"),Nn(l,s)}c.push(l)}return An(u,c),i},Lc=function(t,n){t.selection.select(n.dom(),!0),t.selection.collapse(!0)},Fc=function(t,n,e){var r,o=uc(t),i={styles:o,attributes:ic(t),percentages:(r=o.width,b(r)&&-1!==r.indexOf("%")&&!hc(t))},c=_c(e,n,0,0,i);st(c,"data-mce-id","__mce");var a=function(t){var n=xt.fromTag("div"),e=xt.fromDom(t.dom().cloneNode(!0));return Nn(n,e),function(t){return t.dom().innerHTML}(n)}(c);return t.insertContent(a),te(Yu(t),'table[data-mce-id="__mce"]').map((function(n){return hc(t)&&Dt(n,"width",Nt(n,"width")),ht(n,"data-mce-id"),function(t,n){N(Kn(n,"tr"),(function(n){pc(t,n.dom()),N(Kn(n,"th,td"),(function(n){vc(t,n.dom())}))}))}(t,n),function(t,n){te(n,"td,th").each(u(Lc,t))}(t,n),n.dom()})).getOr(null)};function jc(t,n,e,r){if("TD"===n.tagName||"TH"===n.tagName)t.setStyle(n,e,r);else if(n.children)for(var o=0;o<n.children.length;o++)jc(t,n.children[o],e,r)}var zc,Hc=function(t,n,e){var r,o,i=t.dom;lc(t)&&kc.syncAdvancedStyleFields(t,e),!1===(o=e.control.rootControl.toJSON()).class&&delete o.class,t.undoManager.transact((function(){n||(n=Fc(t,o.cols||1,o.rows||1)),function(t,n,e){var r,o=t.dom,i={},u={};if(i.class=e.class,u.height=$u(e.height),o.getAttrib(n,"width")&&!sc(t)?i.width=(r=e.width)?r.replace(/px$/,""):"":u.width=$u(e.width),sc(t)?(u["border-width"]=$u(e.border),u["border-spacing"]=$u(e.cellspacing),Cc.extend(i,{"data-mce-border-color":e.borderColor,"data-mce-cell-padding":e.cellpadding,"data-mce-border":e.border})):Cc.extend(i,{border:e.border,cellpadding:e.cellpadding,cellspacing:e.cellspacing}),sc(t)&&n.children)for(var c=0;c<n.children.length;c++)jc(o,n.children[c],{"border-width":$u(e.border),"border-color":e.borderColor,padding:$u(e.cellpadding)});e.style?Cc.extend(u,o.parseStyle(e.style)):u=Cc.extend({},o.parseStyle(o.getAttrib(n,"style")),u),i.style=o.serializeStyle(u),o.setAttribs(n,i)}(t,n,o),(r=i.select("caption",n)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=Wc.ie?" ":'<br data-mce-bogus="1"/>',n.insertBefore(r,n.firstChild)),Tc(t,n),o.align&&Rc(t,n,o.align),t.focus(),t.addVisual()}))},Uc=function(t,n){var e,r,o,i,c,a=t.dom,l={};!0===n?(e=a.getParent(t.selection.getStart(),"table"))&&(l=function(t,n){var e=t.dom,r={width:e.getStyle(n,"width")||e.getAttrib(n,"width"),height:e.getStyle(n,"height")||e.getAttrib(n,"height"),cellspacing:e.getStyle(n,"border-spacing")||e.getAttrib(n,"cellspacing"),cellpadding:e.getAttrib(n,"data-mce-cell-padding")||e.getAttrib(n,"cellpadding")||Oc(t.dom,n,"padding"),border:e.getAttrib(n,"data-mce-border")||e.getAttrib(n,"border")||Oc(t.dom,n,"border"),borderColor:e.getAttrib(n,"data-mce-border-color"),caption:!!e.select("caption",n)[0],class:e.getAttrib(n,"class")};return Cc.each("left center right".split(" "),(function(e){t.formatter.matchNode(n,"align"+e)&&(r.align=e)})),lc(t)&&Cc.extend(r,kc.extractAdvancedStyles(e,n)),r}(t,e)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),gc(t).length>0&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:kc.buildListItems(gc(t),(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[n.value]})})}))}),c={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:fc(t)?[r,o,{label:"Width",name:"width",onchange:u(kc.updateStyleField,t)},{label:"Height",name:"height",onchange:u(kc.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:u(kc.updateStyleField,t)},{label:"Height",name:"height",onchange:u(kc.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},lc(t)?t.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},kc.createStyleForm(t)],onsubmit:u(Hc,t,e)}):t.windowManager.open({title:"Table properties",data:l,body:c,onsubmit:u(Hc,t,e)})},qc=Cc.each,Vc=function(t,n,r,o,i){var c=Ju(t),l=function(n){return function(){return p.from(t.dom.getParent(t.selection.getStart(),n)).map(xt.fromDom)}},f=l("caption"),s=l("th,td"),d=function(t){return ae(t,c)},m=function(t){return{width:Xu(t.dom()),height:Xu(t.dom())}},g=function(n){s().each((function(e){d(e).each((function(i){var u=Lr.forMenu(o,i,e),c=m(i);n(i,u).each((function(n){!function(t,n,e){var r=m(e);n.width===r.width&&n.height===r.height||(bc(t,e.dom(),n.width,n.height),wc(t,e.dom(),r.width,r.height))}(t,c,i),t.selection.setRng(n),t.focus(),r.clear(i),Qu(i)}))}))}))},h=function(n){return s().bind((function(n){return d(n).bind((function(r){var i=xt.fromDom(t.getDoc()),u=Lr.forMenu(o,r,n),c=Me(e,i,p.none());return xc(r,u,c)}))}))},v=function(n){i.get().each((function(e){var i=O(e,(function(t){return ke(t)}));s().each((function(e){d(e).each((function(u){var c=xt.fromDom(t.getDoc()),a=_e(c),l=Lr.pasteRows(o,u,e,i,a);n(u,l).each((function(n){t.selection.setRng(n),t.focus(),r.clear(u)}))}))}))}))};qc({mceTableSplitCells:function(){g(n.unmergeCells)},mceTableMergeCells:function(){g(n.mergeCells)},mceTableInsertRowBefore:function(){g(n.insertRowsBefore)},mceTableInsertRowAfter:function(){g(n.insertRowsAfter)},mceTableInsertColBefore:function(){g(n.insertColumnsBefore)},mceTableInsertColAfter:function(){g(n.insertColumnsAfter)},mceTableDeleteCol:function(){g(n.deleteColumn)},mceTableDeleteRow:function(){g(n.deleteRow)},mceTableCutRow:function(t){i.set(h()),g(n.deleteRow)},mceTableCopyRow:function(t){i.set(h())},mceTablePasteRowBefore:function(t){v(n.pasteRowsBefore)},mceTablePasteRowAfter:function(t){v(n.pasteRowsAfter)},mceTableDelete:function(){s().orThunk(f).each((function(n){ae(n,c).filter(a(c)).each((function(n){var e=xt.fromText("");Dn(n,e),In(n);var r=t.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),t.selection.setRng(r)}))}))}},(function(n,e){t.addCommand(e,n)})),qc({mceInsertTable:u(Uc,t),mceTableProps:u(Uc,t,!0),mceTableRowProps:u(Bc,t),mceTableCellProps:u(Pc,t)},(function(n,e){t.addCommand(e,(function(t,e){n(e)}))}))},Gc=function(t){var n=p.from(t.dom().documentElement).map(xt.fromDom).getOr(t);return{parent:o(n),view:o(t),origin:o(ao(0,0))}},Yc=function(t,n){return{parent:o(n),view:o(t),origin:o(ao(0,0))}},Xc=function(t){var n=q.apply(null,t),e=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");e.push(t)},unbind:function(t){e=E(e,(function(n){return n!==t}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.apply(null,t);N(e,(function(t){t(o)}))}}},Kc=function(t){return{registry:H(t,(function(t){return{bind:t.bind,unbind:t.unbind}})),trigger:H(t,(function(t){return t.trigger}))}},Jc=function(t,n){return function(e){if(t(e)){var i=xt.fromDom(e.target),u=function(){e.stopPropagation()},c=function(){e.preventDefault()},a=r(c,u),l=function(t,n,e,r,i,u,c){return{target:o(t),x:o(n),y:o(e),stop:r,prevent:i,kill:u,raw:o(c)}}(i,e.clientX,e.clientY,u,c,a,e);n(l)}}},$c=function(t,n,e,r){return function(t,n,e,r,o){var i=Jc(e,r);return t.dom().addEventListener(n,i,o),{unbind:u(Qc,t,n,i,o)}}(t,n,e,r,!1)},Qc=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},Zc=o(!0),ta=function(t,n,e){return $c(t,n,Zc,e)},na=Object.prototype.hasOwnProperty,ea=(zc=function(t,n){return n},function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},r=0;r<t.length;r++){var o=t[r];for(var i in o)na.call(o,i)&&(e[i]=zc(e[i],o[i]))}return e}),ra={resolve:Uo("ephox-dragster").resolve},oa=yu(["compare","extract","mutate","sink"]),ia=yu(["element","start","stop","destroy"]),ua=yu(["forceDrop","drop","move","delayDrop"]),ca=oa({compare:function(t,n){return ao(n.left()-t.left(),n.top()-t.top())},extract:function(t){return p.some(ao(t.x(),t.y()))},sink:function(t,n){var e=function(t){var n=ea({layerClass:ra.resolve("blocker")},t),e=xt.fromTag("div");return st(e,"role","presentation"),Ot(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Mo(e,ra.resolve("blocker")),Mo(e,n.layerClass),{element:function(){return e},destroy:function(){In(e)}}}(n),r=ta(e.element(),"mousedown",t.forceDrop),o=ta(e.element(),"mouseup",t.drop),i=ta(e.element(),"mousemove",t.move),u=ta(e.element(),"mouseout",t.delayDrop);return ia({element:e.element,start:function(t){Nn(t,e.element())},stop:function(){In(e.element())},destroy:function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,n){t.mutate(n.left(),n.top())}});function aa(){var t=p.none(),n=Kc({move:Xc(["info"])});return{onEvent:function(e,r){r.extract(e).each((function(e){var o=function(n,e){var r=t.map((function(t){return n.compare(t,e)}));return t=p.some(e),r}(r,e);o.each((function(t){n.trigger.move(t)}))}))},reset:function(){t=p.none()},events:n.registry}}function la(){var t={onEvent:e,reset:e},n=aa(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(t,n){r.onEvent(t,n)},events:n.events}}var fa=function(n,e,r){var o,i,u,c=!1,a=Kc({start:Xc([]),stop:Xc([])}),l=la(),f=function(){m.stop(),l.isOn()&&(l.off(),a.trigger.stop())},s=(o=f,i=200,u=null,{cancel:function(){null!==u&&(t.clearTimeout(u),u=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==u&&t.clearTimeout(u),u=t.setTimeout((function(){o.apply(null,n),u=null}),i)}});l.events.move.bind((function(t){e.mutate(n,t.info())}));var d=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];c&&t.apply(null,n)}},m=e.sink(ua({forceDrop:f,drop:d(f),move:d((function(t){s.cancel(),l.onEvent(t,e)})),delayDrop:d(s.throttle)}),r);return{element:m.element,go:function(t){m.start(t),l.on(),a.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){m.destroy()},events:a.registry}},sa=function(t,n){void 0===n&&(n={});var e=void 0!==n.mode?n.mode:ca;return fa(t,e,n)},da=function(){var t=Kc({drag:Xc(["xDelta","yDelta","target"])}),n=p.none(),e=function(){var t=Kc({drag:Xc(["xDelta","yDelta"])});return{mutate:function(n,e){t.trigger.drag(n,e)},events:t.registry}}();return e.events.drag.bind((function(e){n.each((function(n){t.trigger.drag(e.xDelta(),e.yDelta(),n)}))})),{assign:function(t){n=p.some(t)},get:function(){return n},mutate:e.mutate,events:t.registry}},ma=function(t){return"true"===mt(t,"contenteditable")},ga=Vo.resolve("resizer-bar-dragging"),ha=function(t,n,e){var r=da(),o=sa(r,{}),i=p.none(),c=function(t,n){return p.from(mt(t,n))};r.events.drag.bind((function(t){c(t.target(),"data-row").each((function(n){var e=$i.getInt(t.target(),"top");Dt(t.target(),"top",e+t.yDelta()+"px")})),c(t.target(),"data-column").each((function(n){var e=$i.getInt(t.target(),"left");Dt(t.target(),"left",e+t.xDelta()+"px")}))}));var a=function(t,n){return $i.getInt(t,n)-parseInt(mt(t,"data-initial-"+n),10)};o.events.stop.bind((function(){r.get().each((function(r){i.each((function(o){c(r,"data-row").each((function(t){var n=a(r,"top");ht(r,"data-initial-top"),g.trigger.adjustHeight(o,n,parseInt(t,10))})),c(r,"data-column").each((function(t){var n=a(r,"left");ht(r,"data-initial-left"),g.trigger.adjustWidth(o,n,parseInt(t,10))})),ni(t,o,e,n)}))}))}));var l=function(n,e){g.trigger.startAdjust(),r.assign(n),st(n,"data-initial-"+e,parseInt(Nt(n,e),10)),Mo(n,ga),Dt(n,"opacity","0.2"),o.go(t.parent())},f=ta(t.parent(),"mousedown",(function(t){ii(t.target())&&l(t.target(),"top"),ui(t.target())&&l(t.target(),"left")})),s=function(n){return hn(n,t.view())},d=function(t){return ne(t,"table",s).filter((function(t){return function(t,n){return ne(t,"[contenteditable]",n)}(t,s).exists(ma)}))},m=ta(t.view(),"mouseover",(function(r){d(r.target()).fold((function(){Ct(r.target())&&oi(t)}),(function(r){i=p.some(r),ni(t,r,e,n)}))})),g=Kc({adjustHeight:Xc(["table","delta","row"]),adjustWidth:Xc(["table","delta","column"]),startAdjust:Xc([])});return{destroy:function(){f.unbind(),m.unbind(),o.destroy(),oi(t)},refresh:function(r){ni(t,r,e,n)},on:o.on,off:o.off,hideBars:u(ei,t),showBars:u(ri,t),events:g.registry}},pa=function(t,n){return t.inline?Yc(Yu(t),function(){var t=xt.fromTag("div");return Ot(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Nn(Rt(),t),t}()):Gc(xt.fromDom(t.getDoc()))},va=function(t,n){t.inline&&In(n.parent())},ba=function(t){var n,e,r=p.none(),o=p.none(),i=p.none(),u=/(\d+(\.\d+)?)%/,c=function(t){return"TABLE"===t.nodeName};return t.on("init",(function(){var n=To(nc),e=pa(t);if(i=p.some(e),function(t){var n=t.getParam("object_resizing",!0);return"table"===n||n}(t)&&function(t){return t.getParam("table_resize_bars",!0,"boolean")}(t)){var u=function(t,n){var e=Ro.height,r=ha(t,n,e),o=Kc({beforeResize:Xc(["table"]),afterResize:Xc(["table"]),startDrag:Xc([])});return r.events.adjustHeight.bind((function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());hu(t.table(),n,t.row(),e),o.trigger.afterResize(t.table())})),r.events.startAdjust.bind((function(t){o.trigger.startDrag()})),r.events.adjustWidth.bind((function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());gu(t.table(),e,t.column(),n),o.trigger.afterResize(t.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}(e,n);u.on(),u.events.startDrag.bind((function(n){r=p.some(t.selection.getRng())})),u.events.beforeResize.bind((function(n){var e=n.table().dom();bc(t,e,Xu(e),Ku(e))})),u.events.afterResize.bind((function(n){var e=n.table(),o=e.dom();Qu(e),r.each((function(n){t.selection.setRng(n),t.focus()})),wc(t,o,Xu(o),Ku(o)),t.undoManager.add()})),o=p.some(u)}})),t.on("ObjectResizeStart",(function(r){var o,i=r.target;c(i)&&(n=r.width,o=i,e=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"))})),t.on("ObjectResized",(function(r){var o=r.target;if(c(o)){var i=o;if(u.test(e)){var a=parseFloat(u.exec(e)[1]),l=r.width*a/n;t.dom.setStyle(i,"width",l+"%")}else{var f=[];Cc.each(i.rows,(function(n){Cc.each(n.cells,(function(n){var e=t.dom.getStyle(n,"width",!0);f.push({cell:n,width:e})}))})),Cc.each(f,(function(n){t.dom.setStyle(n.cell,"width",n.width),t.dom.setAttrib(n.cell,"width",null)}))}}})),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(Gc(xt.fromDom(t.getBody())))},destroy:function(){o.each((function(t){t.destroy()})),i.each((function(n){va(t,n)}))}}},wa=Er([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),ya=Oo({},wa,{none:function(t){return void 0===t&&(t=void 0),wa.none(t)}}),xa=function(t,n){return ae(t,n).bind((function(n){var e=ce(n);return I(e,(function(n){return hn(t,n)})).map((function(t){return{index:o(t),all:o(e)}}))}))},Ca=function(t,n){return xa(t,n).fold((function(){return ya.none(t)}),(function(n){return n.index()+1<n.all().length?ya.middle(t,n.all()[n.index()+1]):ya.last(t)}))},Ra=function(t,n){return xa(t,n).fold((function(){return ya.none()}),(function(n){return n.index()-1>=0?ya.middle(t,n.all()[n.index()-1]):ya.first(t)}))},Sa={create:q("start","soffset","finish","foffset")},Ta=Er([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Da={before:Ta.before,on:Ta.on,after:Ta.after,cata:function(t,n,e,r){return t.fold(n,e,r)},getStart:function(t){return t.fold(i,i,i)}},Oa=Er([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Na={domRange:Oa.domRange,relative:Oa.relative,exact:Oa.exact,exactFromRange:function(t){return Oa.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){var n,e=function(t){return t.match({domRange:function(t){return xt.fromDom(t.startContainer)},relative:function(t,n){return Da.getStart(t)},exact:function(t,n,e,r){return t}})}(t);return n=e,xt.fromDom(n.dom().ownerDocument.defaultView)},range:Sa.create},Ea=function(t,n){t.selectNodeContents(n.dom())},ka=function(t,n,e){var r,o=t.document.createRange();return r=o,n.fold((function(t){r.setStartBefore(t.dom())}),(function(t,n){r.setStart(t.dom(),n)}),(function(t){r.setStartAfter(t.dom())})),function(t,n){n.fold((function(n){t.setEndBefore(n.dom())}),(function(n,e){t.setEnd(n.dom(),e)}),(function(n){t.setEndAfter(n.dom())}))}(o,e),o},Aa=function(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},Pa=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},Ia=Er([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ba=function(t,n,e){return n(xt.fromDom(e.startContainer),e.startOffset,xt.fromDom(e.endContainer),e.endOffset)},Wa=function(t,n){var e=function(t,n){return n.match({domRange:function(t){return{ltr:o(t),rtl:p.none}},relative:function(n,e){return{ltr:wt((function(){return ka(t,n,e)})),rtl:wt((function(){return p.some(ka(t,e,n))}))}},exact:function(n,e,r,o){return{ltr:wt((function(){return Aa(t,n,e,r,o)})),rtl:wt((function(){return p.some(Aa(t,r,o,n,e))}))}}})}(t,n);return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Ia.rtl(xt.fromDom(t.endContainer),t.endOffset,xt.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ba(0,Ia.ltr,e)})):Ba(0,Ia.ltr,e)}(0,e)},Ma=function(t,n){return Wa(t,n).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})},_a=function(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom},La=function(t,n,e,r,o){var i=function(e){var r=t.dom().createRange();return r.setStart(n.dom(),e),r.collapse(!0),r},u=we(n).length,c=function(t,n,e,r,o){if(0===o)return 0;if(n===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(n-c.left);if(e<=c.bottom){if(e<c.top||a>i)return u-1;i=a}}return 0}((function(t){return i(t).getBoundingClientRect()}),e,r,o.right,u);return i(c)},Fa=function(t,n,e,r){return lt(n)?function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getClientRects();return Eo(i,(function(t){return _a(t,e,r)?p.some(t):p.none()})).map((function(o){return La(t,n,e,r,o)}))}(t,n,e,r):function(t,n,e,r){var o=t.dom().createRange(),i=Rn(n);return Eo(i,(function(n){return o.selectNode(n.dom()),_a(o.getBoundingClientRect(),e,r)?Fa(t,n,e,r):p.none()}))}(t,n,e,r)},ja=function(t,n){return n-t.left<t.right-n},za=function(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r},Ha=function(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=ja(o,e);return(!0===i?Te:De)(n).map((function(n){return za(t,n,i)}))},Ua=function(t,n,e){var r=n.dom().getBoundingClientRect(),o=ja(r,e);return p.some(za(t,n,o))},qa=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect();return function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),c=Math.max(i.top,Math.min(i.bottom,r));return Fa(t,n,u,c)}(t,n,Math.max(i.left,Math.min(i.right,e)),Math.max(i.top,Math.min(i.bottom,r)))},Va=document.caretPositionFromPoint?function(t,n,e){return p.from(t.dom().caretPositionFromPoint(n,e)).bind((function(n){if(null===n.offsetNode)return p.none();var e=t.dom().createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),p.some(e)}))}:document.caretRangeFromPoint?function(t,n,e){return p.from(t.dom().caretRangeFromPoint(n,e))}:function(t,n,e){return xt.fromPoint(t,n,e).bind((function(r){var o=function(){return function(t,n,e){return(0===Rn(n).length?Ua:Ha)(t,n,e)}(t,r,n)};return 0===Rn(r).length?o():qa(t,r,n,e).orThunk(o)}))},Ga=function(t,n){var e=ot(t);return"input"===e?Da.after(t):T(["br","img"],e)?0===n?Da.before(t):Da.after(t):Da.on(t,n)},Ya=function(t,n){var e=t.fold(Da.before,Ga,Da.after),r=n.fold(Da.before,Ga,Da.after);return Na.relative(e,r)},Xa=function(t,n,e,r){var o=Ga(t,n),i=Ga(e,r);return Na.relative(o,i)},Ka=function(t,n,e,r){var o=function(t,n,e,r){var o=bn(t).dom().createRange();return o.setStart(t.dom(),n),o.setEnd(e.dom(),r),o}(t,n,e,r),i=hn(t,e)&&n===r;return o.collapsed&&!i},Ja=function(t,n){p.from(t.getSelection()).each((function(t){t.removeAllRanges(),t.addRange(n)}))},$a=function(t,n,e,r,o){var i=Aa(t,n,e,r,o);Ja(t,i)},Qa=function(t,n){return Wa(t,n).match({ltr:function(n,e,r,o){$a(t,n,e,r,o)},rtl:function(n,e,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(n.dom(),e,r.dom(),o);else if(i.extend)try{!function(t,n,e,r,o,i){n.collapse(e.dom(),r),n.extend(o.dom(),i)}(0,i,n,e,r,o)}catch(i){$a(t,r,o,n,e)}else $a(t,r,o,n,e)}})},Za=function(t){var n=Na.getWin(t).dom(),e=function(t,e,r,o){return Aa(n,t,e,r,o)},r=function(t){return t.match({domRange:function(t){var n=xt.fromDom(t.startContainer),e=xt.fromDom(t.endContainer);return Xa(n,t.startOffset,e,t.endOffset)},relative:Ya,exact:Xa})}(t);return Wa(n,r).match({ltr:e,rtl:e})},tl=function(t){var n=xt.fromDom(t.anchorNode),e=xt.fromDom(t.focusNode);return Ka(n,t.anchorOffset,e,t.focusOffset)?p.some(Sa.create(n,t.anchorOffset,e,t.focusOffset)):function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return p.some(Sa.create(xt.fromDom(n.startContainer),n.startOffset,xt.fromDom(e.endContainer),e.endOffset))}return p.none()}(t)},nl=function(t,n){var e=function(t,n){var e=t.document.createRange();return Ea(e,n),e}(t,n);Ja(t,e)},el=function(t){return function(t){return p.from(t.getSelection()).filter((function(t){return t.rangeCount>0})).bind(tl)}(t).map((function(t){return Na.exact(t.start(),t.soffset(),t.finish(),t.foffset())}))},rl=function(t,n){return function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?p.some(e).map(Pa):p.none()}(Ma(t,n))},ol=function(t,n,e){return function(t,n,e){var r=xt.fromDom(t.document);return Va(r,n,e).map((function(t){return Sa.create(xt.fromDom(t.startContainer),t.startOffset,xt.fromDom(t.endContainer),t.endOffset)}))}(t,n,e)},il=tinymce.util.Tools.resolve("tinymce.util.VK"),ul=function(t,n,e,r){return fl(t,n,Ca(e),r)},cl=function(t,n,e,r){return fl(t,n,Ra(e),r)},al=function(t,n){var e=Na.exact(n,0,n,0);return Za(e)},ll=function(t,n){var e,r=Kn(n,"tr");return(e=r,0===e.length?p.none():p.some(e[e.length-1])).bind((function(t){return te(t,"td,th").map((function(t){return al(0,t)}))}))},fl=function(t,n,e,r,o){return e.fold(p.none,p.none,(function(t,n){return Te(n).map((function(t){return al(0,t)}))}),(function(e){return ae(e,n).bind((function(n){var o=Lr.noMenu(e);return t.undoManager.transact((function(){r.insertRowsAfter(n,o)})),ll(0,n)}))}))},sl=["table","li","dl"],dl=function(t,n,e,r){if(t.keyCode===il.TAB){var o=Yu(n),i=function(t){var n=ot(t);return hn(t,o)||T(sl,n)},u=n.selection.getRng();if(u.collapsed){var c=xt.fromDom(u.startContainer);ue(c,i).each((function(o){t.preventDefault(),(t.shiftKey?cl:ul)(n,i,o,e,r).each((function(t){n.selection.setRng(t)}))}))}}},ml={create:q("selection","kill")},gl=function(t,n,e,r){return{start:o(Da.on(t,n)),finish:o(Da.on(e,r))}},hl={convertToRange:function(t,n){var e=Ma(t,n);return Sa.create(xt.fromDom(e.startContainer),e.startOffset,xt.fromDom(e.endContainer),e.endOffset)},makeSitus:gl},pl=function(t,n,e,r,o){return hn(e,r)?p.none():wr(e,r,n).bind((function(n){var r=n.boxes().getOr([]);return r.length>0?(o(t,r,n.start(),n.finish()),p.some(ml.create(p.some(hl.makeSitus(e,0,e,Ce(e))),!0))):p.none()}))},vl={sync:function(t,n,e,r,o,i,u){return hn(e,o)&&r===i?p.none():ne(e,"td,th",n).bind((function(e){return ne(o,"td,th",n).bind((function(r){return pl(t,n,e,r,u)}))}))},detect:pl,update:function(t,n,e,r,o){return xr(r,t,n,o.firstSelectedSelector(),o.lastSelectedSelector()).map((function(t){return o.clear(e),o.selectRange(e,t.boxes(),t.start(),t.finish()),t.boxes()}))}},bl=q("item","mode"),wl=function(t,n,e,r){return void 0===r&&(r=yl),t.property().parent(n).map((function(t){return bl(t,r)}))},yl=function(t,n,e,r){return void 0===r&&(r=xl),e.sibling(t,n).map((function(t){return bl(t,r)}))},xl=function(t,n,e,r){void 0===r&&(r=xl);var o=t.property().children(n);return e.first(o).map((function(t){return bl(t,r)}))},Cl=[{current:wl,next:yl,fallback:p.none()},{current:yl,next:xl,fallback:p.some(wl)},{current:xl,next:xl,fallback:p.some(yl)}],Rl=function(t,n,e,r,o){return void 0===o&&(o=Cl),P(o,(function(t){return t.current===e})).bind((function(e){return e.current(t,n,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return Rl(t,n,e,r)}))}))}))},Sl=function(){return{sibling:function(t,n){return t.query().prevSibling(n)},first:function(t){return t.length>0?p.some(t[t.length-1]):p.none()}}},Tl=function(){return{sibling:function(t,n){return t.query().nextSibling(n)},first:function(t){return t.length>0?p.some(t[0]):p.none()}}},Dl=function(t,n,e,r,o,i){return Rl(t,n,r,o).bind((function(n){return i(n.item())?p.none():e(n.item())?p.some(n.item()):Dl(t,n.item(),e,n.mode(),o,i)}))},Ol=function(t){return function(n){return 0===t.property().children(n).length}},Nl=function(t,n,e,r){return Dl(t,n,e,yl,Sl(),r)},El=function(t,n,e,r){return Dl(t,n,e,yl,Tl(),r)},kl=Ze(),Al=function(t,n){return function(t,n,e){return Nl(t,n,Ol(t),e)}(kl,t,n)},Pl=function(t,n){return function(t,n,e){return El(t,n,Ol(t),e)}(kl,t,n)},Il=q("element","offset"),Bl=(q("element","deltaOffset"),q("element","start","finish"),q("begin","end"),q("element","text"),Er([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),Wl=function(t){return ne(t,"tr")},Ml=Oo({},Bl,{verify:function(t,n,e,r,o,i,u){return ne(r,"td,th",u).bind((function(e){return ne(n,"td,th",u).map((function(n){return hn(e,n)?hn(r,e)&&Ce(e)===o?i(n):Bl.none("in same cell"):gr(Wl,[e,n]).fold((function(){return function(t,n,e){var r=t.getRect(n),o=t.getRect(e);return o.right>r.left&&o.left<r.right}(t,n,e)?Bl.success():i(n)}),(function(t){return i(n)}))}))})).getOr(Bl.none("default"))},cata:function(t,n,e,r,o){return t.fold(n,e,r,o)}}),_l=(q("ancestor","descendants","element","index"),q("parent","children","element","index")),Ll=function(t,n){return I(t,u(hn,n))},Fl=function(t){return"br"===ot(t)},jl=function(t,n,e){return n(t,e).bind((function(t){return lt(t)&&0===we(t).trim().length?jl(t,n,e):p.some(t)}))},zl=function(t,n,e,r){return function(t,n){return Sn(t,n).filter(Fl).orThunk((function(){return Sn(t,n-1).filter(Fl)}))}(n,e).bind((function(n){return r.traverse(n).fold((function(){return jl(n,r.gather,t).map(r.relative)}),(function(t){return function(t){return wn(t).bind((function(n){var e=Rn(n);return Ll(e,t).map((function(r){return _l(n,e,t,r)}))}))}(t).map((function(t){return Da.on(t.parent(),t.index())}))}))}))},Hl=function(t,n,e,r){var i=Fl(n)?function(t,n,e){return e.traverse(n).orThunk((function(){return jl(n,e.gather,t)})).map(e.relative)}(t,n,r):zl(t,n,e,r);return i.map((function(t){return{start:o(t),finish:o(t)}}))},Ul=function(t){return Ml.cata(t,(function(t){return p.none()}),(function(){return p.none()}),(function(t){return p.some(Il(t,0))}),(function(t){return p.some(Il(t,Ce(t)))}))},ql=J(["left","top","right","bottom"],[]),Vl={nu:ql,moveUp:function(t,n){return ql({left:t.left(),top:t.top()-n,right:t.right(),bottom:t.bottom()-n})},moveDown:function(t,n){return ql({left:t.left(),top:t.top()+n,right:t.right(),bottom:t.bottom()+n})},moveBottomTo:function(t,n){var e=t.bottom()-t.top();return ql({left:t.left(),top:n-e,right:t.right(),bottom:n})},moveTopTo:function(t,n){var e=t.bottom()-t.top();return ql({left:t.left(),top:n,right:t.right(),bottom:n+e})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,n,e){return ql({left:t.left()+n,top:t.top()+e,right:t.right()+n,bottom:t.bottom()+e})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},Gl=function(t){return Vl.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Yl=function(t,n){return p.some(t.getRect(n))},Xl=function(t,n,e){return at(n)?Yl(t,n).map(Gl):lt(n)?function(t,n,e){return e>=0&&e<Ce(n)?t.getRangedRect(n,e,n,e+1):e>0?t.getRangedRect(n,e-1,n,e):p.none()}(t,n,e).map(Gl):p.none()},Kl=function(t,n){return at(n)?Yl(t,n).map(Gl):lt(n)?t.getRangedRect(n,0,n,Ce(n)).map(Gl):p.none()},Jl=Er([{none:[]},{retry:["caret"]}]),$l=function(t,n,e){return(r=n,i=Iu,Jn((function(t,n){return n(t)}),$n,r,i,u)).fold(o(!1),(function(n){return Kl(t,n).exists((function(t){return function(t,n){return t.left()<n.left()||Math.abs(n.right()-t.left())<1||t.left()>n.right()}(e,t)}))}));var r,i,u},Ql={point:Vl.getTop,adjuster:function(t,n,e,r,o){var i=Vl.moveUp(o,5);return Math.abs(e.top()-r.top())<1||e.bottom()<o.top()?Jl.retry(i):e.bottom()===o.top()?Jl.retry(Vl.moveUp(o,1)):$l(t,n,o)?Jl.retry(Vl.translate(i,5,0)):Jl.none()},move:Vl.moveUp,gather:Al},Zl={point:Vl.getBottom,adjuster:function(t,n,e,r,o){var i=Vl.moveDown(o,5);return Math.abs(e.bottom()-r.bottom())<1||e.top()>o.bottom()?Jl.retry(i):e.top()===o.bottom()?Jl.retry(Vl.moveDown(o,1)):$l(t,n,o)?Jl.retry(Vl.translate(i,5,0)):Jl.none()},move:Vl.moveDown,gather:Pl},tf=function(t,n,e,r,o){return 0===o?p.some(r):function(t,n,e){return t.elementFromPoint(n,e).filter((function(t){return"table"===ot(t)})).isSome()}(t,r.left(),n.point(r))?function(t,n,e,r,o){return tf(t,n,e,n.move(r,5),o)}(t,n,e,r,o-1):t.situsFromPoint(r.left(),n.point(r)).bind((function(i){return i.start().fold(p.none,(function(i){return Kl(t,i).bind((function(u){return n.adjuster(t,i,u,e,r).fold(p.none,(function(r){return tf(t,n,e,r,o-1)}))})).orThunk((function(){return p.some(r)}))}),p.none)}))},nf=function(t,n,e){var r=t.move(e,5),o=tf(n,t,e,r,100).getOr(r);return function(t,n,e){return t.point(n)>e.getInnerHeight()?p.some(t.point(n)-e.getInnerHeight()):t.point(n)<0?p.some(-t.point(n)):p.none()}(t,o,n).fold((function(){return n.situsFromPoint(o.left(),t.point(o))}),(function(e){return n.scrollBy(0,e),n.situsFromPoint(o.left(),t.point(o)-e)}))},ef={tryUp:u(nf,Ql),tryDown:u(nf,Zl),ieTryUp:function(t,n){return t.situsFromPoint(n.left(),n.top()-5)},ieTryDown:function(t,n){return t.situsFromPoint(n.left(),n.bottom()+5)},getJumpSize:o(5)},rf=fn.detect(),of=function(t,n,e,r,o,i){return 0===i?p.none():af(t,n,e,r,o).bind((function(u){var c=t.fromSitus(u),a=Ml.verify(t,e,r,c.finish(),c.foffset(),o.failure,n);return Ml.cata(a,(function(){return p.none()}),(function(){return p.some(u)}),(function(u){return hn(e,u)&&0===r?uf(t,e,r,Vl.moveUp,o):of(t,n,u,0,o,i-1)}),(function(u){return hn(e,u)&&r===Ce(u)?uf(t,e,r,Vl.moveDown,o):of(t,n,u,Ce(u),o,i-1)}))}))},uf=function(t,n,e,r,o){return Xl(t,n,e).bind((function(n){return cf(t,o,r(n,ef.getJumpSize()))}))},cf=function(t,n,e){return rf.browser.isChrome()||rf.browser.isSafari()||rf.browser.isFirefox()||rf.browser.isEdge()?n.otherRetry(t,e):rf.browser.isIE()?n.ieRetry(t,e):p.none()},af=function(t,n,e,r,o){return Xl(t,e,r).bind((function(n){return cf(t,o,n)}))},lf=function(t,n,e){return function(t,n,e){return t.getSelection().bind((function(r){return Hl(n,r.finish(),r.foffset(),e).fold((function(){return p.some(Il(r.finish(),r.foffset()))}),(function(o){var i=t.fromSitus(o),u=Ml.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),e.failure,n);return Ul(u)}))}))}(t,n,e).bind((function(r){return of(t,n,r.element(),r.offset(),e,20).map(t.fromSitus)}))},ff=fn.detect(),sf=function(t,n){return $n(t,(function(t){return wn(t).exists((function(t){return hn(t,n)}))}),e).isSome();var e},df=function(t,n,e,r,i){return ne(r,"td,th",n).bind((function(r){return ne(r,"table",n).bind((function(u){return sf(i,u)?lf(t,n,e).bind((function(t){return ne(t.finish(),"td,th",n).map((function(n){return{start:o(r),finish:o(n),range:o(t)}}))})):p.none()}))}))},mf=function(t,n,e,r,o,i){return ff.browser.isIE()?p.none():i(r,n).orThunk((function(){return df(t,n,e,r,o).map((function(t){var n=t.range();return ml.create(p.some(hl.makeSitus(n.start(),n.soffset(),n.finish(),n.foffset())),!0)}))}))},gf=function(t,n,e,r,o,i,u){return df(t,e,r,o,i).bind((function(t){return vl.detect(n,e,t.start(),t.finish(),u)}))},hf=function(t,n){return ne(t,"tr",n).bind((function(t){return ne(t,"table",n).bind((function(e){var r=Kn(e,"tr");return hn(t,r[0])?function(t,n,e){return Nl(kl,t,n,e)}(e,(function(t){return De(t).isSome()}),n).map((function(t){var n=Ce(t);return ml.create(p.some(hl.makeSitus(t,n,t,n)),!0)})):p.none()}))}))},pf=function(t,n){return ne(t,"tr",n).bind((function(t){return ne(t,"table",n).bind((function(e){var r=Kn(e,"tr");return hn(t,r[r.length-1])?function(t,n,e){return El(kl,t,n,e)}(e,(function(t){return Te(t).isSome()}),n).map((function(t){return ml.create(p.some(hl.makeSitus(t,0,t,0)),!0)})):p.none()}))}))},vf=function(t,n){return ne(t,"td,th",n)},bf={down:{traverse:Cn,gather:Pl,relative:Da.before,otherRetry:ef.tryDown,ieRetry:ef.ieTryDown,failure:Ml.failedDown},up:{traverse:xn,gather:Al,relative:Da.before,otherRetry:ef.tryUp,ieRetry:ef.ieTryUp,failure:Ml.failedUp}},wf=function(t){return function(n){return n===t}},yf=wf(38),xf=wf(40),Cf={ltr:{isBackward:wf(37),isForward:wf(39)},rtl:{isBackward:wf(39),isForward:wf(37)},isUp:yf,isDown:xf,isNavigation:function(t){return t>=37&&t<=40}},Rf=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},Sf=(fn.detect().browser.isSafari(),function(n){return{elementFromPoint:function(t,e){return xt.fromPoint(xt.fromDom(n.document),t,e)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,e,r,o){var i=Na.exact(t,e,r,o);return rl(n,i).map(Rf)},getSelection:function(){return el(n).map((function(t){return hl.convertToRange(n,t)}))},fromSitus:function(t){var e=Na.relative(t.start(),t.finish());return hl.convertToRange(n,e)},situsFromPoint:function(t,e){return ol(n,t,e).map((function(t){return gl(t.start(),t.soffset(),t.finish(),t.foffset())}))},clearSelection:function(){!function(t){t.getSelection().removeAllRanges()}(n)},setSelection:function(t){!function(t,n,e,r,o){var i=Xa(n,e,r,o);Qa(t,i)}(n,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,e){!function(t,n,e){var r=Ya(n,e);Qa(t,r)}(n,t,e)},selectContents:function(t){nl(n,t)},getInnerHeight:function(){return n.innerHeight},getScrollY:function(){var e,r,o,i;return(e=xt.fromDom(n.document),r=void 0!==e?e.dom():t.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,i=r.body.scrollTop||r.documentElement.scrollTop,ao(o,i)).top()},scrollBy:function(e,r){!function(n,e,r){(void 0!==r?r.dom():t.document).defaultView.scrollBy(n,e)}(e,r,xt.fromDom(n.document))}}}),Tf=q("rows","cols"),Df=function(t,n,e,r){var o=function(t,n,e,r){var o=p.none(),i=function(){o=p.none()};return{mousedown:function(t){r.clear(n),o=vf(t.target(),e)},mouseover:function(i){o.each((function(o){r.clear(n),vf(i.target(),e).each((function(i){wr(o,i,e).each((function(e){var u=e.boxes().getOr([]);(u.length>1||1===u.length&&!hn(o,i))&&(r.selectRange(n,u,e.start(),e.finish()),t.selectContents(i))}))}))}))},mouseup:function(t){o.each(i)}}}(Sf(t),n,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},Of=function(t,n,e,r){var o=Sf(t),i=function(){return r.clear(n),p.none()};return{keydown:function(t,c,a,l,f,s){var d=t.raw(),m=d.which,g=!0===d.shiftKey,h=yr(n,r.selectedSelector()).fold((function(){return Cf.isDown(m)&&g?u(gf,o,n,e,bf.down,l,c,r.selectRange):Cf.isUp(m)&&g?u(gf,o,n,e,bf.up,l,c,r.selectRange):Cf.isDown(m)?u(mf,o,e,bf.down,l,c,pf):Cf.isUp(m)?u(mf,o,e,bf.up,l,c,hf):p.none}),(function(t){var e=function(e){return function(){var i=Eo(e,(function(e){return vl.update(e.rows(),e.cols(),n,t,r)}));return i.fold((function(){return Cr(n,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(t){var e=Cf.isDown(m)||s.isForward(m)?Da.after:Da.before;return o.setRelativeSelection(Da.on(t.first(),0),e(t.table())),r.clear(n),ml.create(p.none(),!0)}))}),(function(t){return p.some(ml.create(p.none(),!0))}))}};return Cf.isDown(m)&&g?e([Tf(1,0)]):Cf.isUp(m)&&g?e([Tf(-1,0)]):s.isBackward(m)&&g?e([Tf(0,-1),Tf(-1,0)]):s.isForward(m)&&g?e([Tf(0,1),Tf(1,0)]):Cf.isNavigation(m)&&!1===g?i:p.none}));return h()},keyup:function(t,o,i,u,c){return yr(n,r.selectedSelector()).fold((function(){var a=t.raw(),l=a.which;return 0==(!0===a.shiftKey)?p.none():Cf.isNavigation(l)?vl.sync(n,e,o,i,u,c,r.selectRange):p.none()}),p.none)}}},Nf=function(t){var n=function(n){ht(n,t.selected()),ht(n,t.firstSelected()),ht(n,t.lastSelected())},e=function(n){st(n,t.selected(),"1")},r=function(e){var r=Kn(e,t.selectedSelector());N(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),N(o,e),st(i,t.firstSelected(),"1"),st(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},Ef=function(t){return!1===_o(xt.fromDom(t.target),"ephox-snooker-resizer-bar")},kf=Cc.each,Af=function(t){var n=[];function e(n){return function(){t.execCommand(n)}}kf("inserttable tableprops deletetable | cell row column".split(" "),(function(e){"|"===e?n.push({text:"-"}):n.push(t.menuItems[e])})),t.addButton("table",{type:"menubutton",title:"Table",menu:n}),t.addButton("tableprops",{title:"Table properties",onclick:e("mceTableProps"),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:e("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:e("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:e("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:e("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:e("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:e("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:e("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:e("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:e("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:e("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:e("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:e("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:e("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:e("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:e("mceTableDeleteCol")})},Pf=function(t){var n=function(t){var n=t.getParam("table_toolbar",ec);return""===n||!1===n?[]:b(n)?n.split(/[ ,]/):w(n)?n:[]}(t);n.length>0&&t.addContextToolbar((function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)}),n.join(" "))},If=function(t,n){var e=p.none(),r=[],o=[],i=[],u=[],c=function(t){t.disabled(!0)},a=function(t){t.disabled(!1)},l=function(){var t=this;r.push(t),e.fold((function(){c(t)}),(function(n){a(t)}))},f=function(){var t=this;o.push(t),e.fold((function(){c(t)}),(function(n){a(t)}))};t.on("init",(function(){t.on("nodechange",(function(l){var f=p.from(t.dom.getParent(t.selection.getStart(),"th,td"));e=f.bind((function(t){var e=xt.fromDom(t);return ae(e).map((function(t){return Lr.forMenu(n,t,e)}))})),e.fold((function(){N(r,c),N(o,c),N(i,c),N(u,c)}),(function(t){N(r,a),N(o,a),N(i,(function(n){n.disabled(t.mergable().isNone())})),N(u,(function(n){n.disabled(t.unmergable().isNone())}))}))}))}));var s=function(t,n,e,r){var o,i,u,c,a,l=r.getEl().getElementsByTagName("table")[0],f=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=n+1+" x "+(e+1),f&&(n=9-n),i=0;i<10;i++)for(o=0;o<10;o++)c=l.rows[i].childNodes[o].firstChild,a=(f?o>=n:o<=n)&&i<=e,t.dom.toggleClass(c,"mce-active",a),a&&(u=c);return u.parentNode},d=!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?{text:"Table",icon:"table",context:"table",onclick:m("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(n){n.aria&&(this.parent().hideAll(),n.stopImmediatePropagation(),t.execCommand("mceInsertTable"))},onshow:function(){s(t,0,0,this.menu.items()[0])},onhide:function(){var n=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(n,"mce-active"),t.dom.addClass(n[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var n=0;n<10;n++){t+="<tr>";for(var e=0;e<10;e++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*n+e)+'" href="#" data-mce-x="'+e+'" data-mce-y="'+n+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(n){var e,r,o=n.target;"A"===o.tagName.toUpperCase()&&(e=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(e=9-e),e===this.lastX&&r===this.lastY||(s(t,e,r,n.control),this.lastX=e,this.lastY=r))},onclick:function(n){var e=this;"A"===n.target.tagName.toUpperCase()&&(n.preventDefault(),n.stopPropagation(),e.parent().cancel(),t.undoManager.transact((function(){Fc(t,e.lastX+1,e.lastY+1)})),t.addVisual())}}]};function m(n){return function(){t.execCommand(n)}}var g={text:"Table properties",context:"table",onPostRender:l,onclick:m("mceTableProps")},h={text:"Delete table",context:"table",onPostRender:l,cmd:"mceTableDelete"},v={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:m("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:m("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:m("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:m("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:m("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:m("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:m("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:m("mceTablePasteRowAfter"),onPostRender:f}]},b={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:m("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:m("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:m("mceTableDeleteCol"),onPostRender:f}]},w={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:m("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:m("mceTableMergeCells"),onPostRender:function(){var t=this;i.push(t),e.fold((function(){c(t)}),(function(n){t.disabled(n.mergable().isNone())}))}},{text:"Split cell",onclick:m("mceTableSplitCells"),onPostRender:function(){var t=this;u.push(t),e.fold((function(){c(t)}),(function(n){t.disabled(n.unmergable().isNone())}))}}]};t.addMenuItem("inserttable",d),t.addMenuItem("tableprops",g),t.addMenuItem("deletetable",h),t.addMenuItem("row",v),t.addMenuItem("column",b),t.addMenuItem("cell",w)},Bf=function(t,n){return{insertTable:function(n,e){return Fc(t,n,e)},setClipboardRows:function(t){return function(t,n){var e=O(t,xt.fromDom);n.set(p.from(e))}(t,n)},getClipboardRows:function(){return function(t){return t.get().fold((function(){}),(function(t){return O(t,(function(t){return t.dom()}))}))}(n)}}};n.add("table",(function(t){var n=ba(t),i=function(t,n){var i=J(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=p.none(),c=Nf(Nr);return t.on("init",(function(a){var l=t.getWin(),f=Yu(t),s=Ju(t),d=Df(l,f,s,c),m=Of(l,f,s,c),g=function(n,e){(function(t){return!0===t.raw().shiftKey})(n)&&(e.kill()&&n.kill(),e.selection().each((function(n){var e=Na.relative(n.start(),n.finish()),r=Ma(l,e);t.selection.setRng(r)})))},h=function(n){var e=w(n);if(e.raw().shiftKey&&Cf.isNavigation(e.raw().which)){var r=t.selection.getRng(),o=xt.fromDom(r.startContainer),i=xt.fromDom(r.endContainer);m.keyup(e,o,r.startOffset,i,r.endOffset).each((function(t){g(e,t)}))}},v=function(e){var r=w(e);n().each((function(t){t.hideBars()}));var o=t.selection.getRng(),i=xt.fromDom(t.selection.getStart()),u=xt.fromDom(o.startContainer),c=xt.fromDom(o.endContainer),a=nc(i).isRtl()?Cf.rtl:Cf.ltr;m.keydown(r,u,o.startOffset,c,o.endOffset,a).each((function(t){g(r,t)})),n().each((function(t){t.showBars()}))},b=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},w=function(t){var n=xt.fromDom(t.target),e=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=r(i,e);return{target:o(n),x:o(b(t)?t.x:null),y:o(b(t)?t.y:null),stop:e,prevent:i,kill:u,raw:o(t)}},y=function(t){return 0===t.button},x=function(t){y(t)&&Ef(t)&&d.mousedown(w(t))},C=function(t){var n;void 0!==(n=t).buttons&&0==(1&n.buttons)||!Ef(t)||d.mouseover(w(t))},R=function(t){y(t)&&Ef(t)&&d.mouseup(w(t))};t.on("mousedown",x),t.on("mouseover",C),t.on("mouseup",R),t.on("keyup",h),t.on("keydown",v),t.on("nodechange",(function(){var n=t.selection,r=xt.fromDom(n.getStart()),o=xt.fromDom(n.getEnd());gr(ae,[r,o]).fold((function(){c.clear(f)}),e)})),u=p.some(i({mousedown:x,mouseover:C,mouseup:R,keyup:h,keydown:v}))})),{clear:c.clear,destroy:function(){u.each((function(t){}))}}}(t,n.lazyResize),u=yc(t,n.lazyWire),c=function(t){return{get:function(){var n=Yu(t);return Rr(n,Nr.selectedSelector()).fold((function(){return void 0===t.selection.getStart()?Ar.none():Ar.single(t.selection)}),(function(t){return Ar.multiple(t)}))}}}(t),a=vu(p.none());return Vc(t,u,i,c,a),Fr(t,c,u,i),If(t,c),Af(t),Pf(t),t.on("PreInit",(function(){t.serializer.addTempAttr(Nr.firstSelected()),t.serializer.addTempAttr(Nr.lastSelected())})),function(t){return t.getParam("table_tab_navigation",!0,"boolean")}(t)&&t.on("keydown",(function(e){dl(e,t,u,n.lazyWire)})),t.on("remove",(function(){n.destroy(),i.destroy()})),Bf(t,a)}))}(window);